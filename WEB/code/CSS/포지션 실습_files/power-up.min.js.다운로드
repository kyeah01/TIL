!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e():"function"==typeof define&&define.amd?define(e):e()}(0,function(){"use strict";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}function o(t){return e(t)||i(t)||a()}function e(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function i(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function a(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var t=function(){var t=new Error("yep");return!!t.stack&&"Error: yep\n"===t.stack.substr(0,11)},c=function(t,e,r){var n=e;return r&&(n+=": "+r),t=n+t.slice(t.indexOf("\n"))},u=t();function l(e,t){function r(t){if(!(this instanceof r))return new r(t);try{throw new Error(t)}catch(t){t.name=e,this.stack=t.stack}u&&this.stack&&(this.stack=c(this.stack,e,t)),this.message=t||"",this.name=e}return((r.prototype=new(t||Error)).constructor=r).prototype.inspect=function(){return this.message?"["+e+": "+this.message+"]":"["+e+"]"},r.prototype.name=e,r}var f=l;function p(t){if(this._capacity=_(t),this._length=0,this._front=0,d(t)){for(var e=t.length,r=0;r<e;++r)this[r]=t[r];this._length=e}}p.prototype.toArray=function(){for(var t=this._length,e=new Array(t),r=this._front,n=this._capacity,o=0;o<t;++o)e[o]=this[r+o&n-1];return e},p.prototype.push=function(t){var e=arguments.length,r=this._length;if(1<e){var n=this._capacity;if(n<r+e){for(var o=0;o<e;++o){this._checkCapacity(r+1),this[i=this._front+r&this._capacity-1]=arguments[o],r++,this._length=r}return r}for(var i=this._front,o=0;o<e;++o)this[i+r&n-1]=arguments[o],i++;return this._length=r+e,r+e}return 0===e?r:(this._checkCapacity(r+1),this[o=this._front+r&this._capacity-1]=t,this._length=r+1,r+1)},p.prototype.pop=function(){var t=this._length;if(0!==t){var e=this._front+t-1&this._capacity-1,r=this[e];return this[e]=void 0,this._length=t-1,r}},p.prototype.shift=function(){var t=this._length;if(0!==t){var e=this._front,r=this[e];return this[e]=void 0,this._front=e+1&this._capacity-1,this._length=t-1,r}},p.prototype.unshift=function(t){var e=this._length,r=arguments.length;if(1<r){if((o=this._capacity)<e+r){for(var n=r-1;0<=n;n--){this._checkCapacity(e+1);var o=this._capacity;this[s=(this._front-1&o-1^o)-o]=arguments[n],e++,this._length=e,this._front=s}return e}var i=this._front;for(n=r-1;0<=n;n--){var s;this[s=(i-1&o-1^o)-o]=arguments[n],i=s}return this._front=i,this._length=e+r,e+r}if(0===r)return e;this._checkCapacity(e+1);o=this._capacity;return this[n=(this._front-1&o-1^o)-o]=t,this._length=e+1,this._front=n,e+1},p.prototype.peekBack=function(){var t=this._length;if(0!==t)return this[this._front+t-1&this._capacity-1]},p.prototype.peekFront=function(){if(0!==this._length)return this[this._front]},p.prototype.get=function(t){var e=t;if(e===(0|e)){var r=this._length;if(e<0&&(e+=r),!(e<0||r<=e))return this[this._front+e&this._capacity-1]}},p.prototype.isEmpty=function(){return 0===this._length},p.prototype.clear=function(){for(var t=this._length,e=this._front,r=this._capacity,n=0;n<t;++n)this[e+n&r-1]=void 0;this._length=0,this._front=0},p.prototype.toString=function(){return this.toArray().toString()},p.prototype.valueOf=p.prototype.toString,p.prototype.removeFront=p.prototype.shift,p.prototype.removeBack=p.prototype.pop,p.prototype.insertFront=p.prototype.unshift,p.prototype.insertBack=p.prototype.push,p.prototype.enqueue=p.prototype.push,p.prototype.dequeue=p.prototype.shift,p.prototype.toJSON=p.prototype.toArray,Object.defineProperty(p.prototype,"length",{get:function(){return this._length},set:function(){throw new RangeError("")}}),p.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(_(1.5*this._capacity+16))},p.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var r=this._front,n=this._length;e<r+n&&v(this,0,this,e,r+n&e-1)};var d=Array.isArray;function v(t,e,r,n,o){for(var i=0;i<o;++i)r[i+n]=t[i+e],t[i+e]=void 0}function y(t){return t>>>=0,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}function _(t){if("number"!=typeof t){if(!d(t))return 16;t=t.length}return y(Math.min(Math.max(16,t),1073741824))}var g=p,m=b,w=Object.prototype.hasOwnProperty;function b(){for(var t={},e=0;e<arguments.length;e++){var r=arguments[e];for(var n in r)w.call(r,n)&&(t[n]=r[n])}return t}function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function j(t,e,r){return e&&C(t.prototype,e),r&&C(t,r),t}function A(t){return F(t)||S(t)||O()}function F(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function S(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function O(){throw new TypeError("Invalid attempt to spread non-iterable instance")}var x="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",P="plugin disabled",T="invalid context",R="not handled",D="unsupported command",I=function(){function l(t){E(this,l),this.local=t.local,this.remote=t.remote,this.targetOrigin=t.targetOrigin,this.secret=t.secret,this.handlers=t.handlers,this.hostHandlers=t.hostHandlers,this.Promise=t.Promise||window.Promise,this.bufferSize=t.bufferSize||256,this._seed=l.randomId(16),this._ctr=0,this._pendingRequests={},this._messageQueues=new Map;try{this._messageQueues.set(this.remote,new g(this.bufferSize))}catch(t){this._targetsFallback={remote:this.remote}}this.listen()}return j(l,[{key:"_handleMessage",value:function(t,e){var r=this,n=t.data;switch(t.type){case"request":this._handleRequest(n.id,n.command,n.args,e);break;case"response":this._handleResponse(n.to,n.success,n.response);break;case"bulk":n.forEach(function(t){return r._handleMessage(t,e)})}}},{key:"listen",value:function(){var r=this;this.stop(),this.listener=function(t){var e=t.source;e!==r.remote&&t.data.secret!==r.secret||r._handleMessage(t.data,e)},this.local.addEventListener("message",this.listener)}},{key:"stop",value:function(){this.local.removeEventListener("message",this.listener)}},{key:"_handleRequest",value:function(e,t,r,n){var o=this,i=m(this.hostHandlers,{PluginDisabled:l.PluginDisabled,InvalidContext:l.InvalidContext,NotHandled:l.NotHandled,command:t,args:r,source:n,request:function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.request.apply(o,A(e.concat([n])))},secret:this.secret});this.Promise.try(function(){if(!Object.prototype.hasOwnProperty.call(o.handlers,t))throw new l.UnsupportedCommand("unsupported command: ".concat(t));return o.handlers[t].apply(o,[i].concat(r))}).then(function(t){o.respond(e,!0,t,n)}).catch(function(t){o.respond(e,!1,{code:t.code,message:t.message},n)})}},{key:"_handleResponse",value:function(t,e,r){if(Object.prototype.hasOwnProperty.call(this._pendingRequests,t))if(e)this._pendingRequests[t].resolve(r),delete this._pendingRequests[t];else{var n=null;switch(r.code){case P:n=new l.PluginDisabled(r.message);break;case T:n=new l.InvalidContext(r.message);break;case R:n=new l.NotHandled(r.message);break;case D:n=new l.UnsupportedCommand(r.message);break;default:n=new Error(r.message)}this._pendingRequests[t].reject(n),delete this._pendingRequests[t]}}},{key:"raw",value:function(t,e,r){var n=this;if("bulk"===t){var o={data:e,secret:this.secret,type:t};r?r.postMessage(o,"*"):this.remote.postMessage(o,this.targetOrigin)}else{var i=r||this.remote;if(this._targetsFallback)if(r===this.remote)i="remote";else{i=void 0;for(var s=Object.keys(this._targetsFallback),a=0;a<s.length;a++){var c=s[a];if(this._targetsFallback[c]===r){i=c;break}}i||(i=l.randomId(8),this._targetsFallback[i]=r)}this._messageQueues.has(i)||this._messageQueues.set(i,new g(this.bufferSize));var u=this._messageQueues.get(i);u.isEmpty()&&setTimeout(function(){return n.emptyQueue(i)},0),u.push({type:t,data:e})}}},{key:"emptyQueue",value:function(t){var e=this._messageQueues.get(t);if(!e.isEmpty()){var r=e.toArray();e.clear();var n="string"==typeof t?this._targetsFallback[t]:t;t!==this.remote&&"remote"!==t&&(this._messageQueues.delete(t),this._targetsFallback&&delete this._targetsFallback[t]),this.raw("bulk",r,n)}}},{key:"request",value:function(r){for(var n=this,t=arguments.length,o=new Array(1<t?t-1:0),e=1;e<t;e++)o[e-1]=arguments[e];this._ctr+=1;var i,s=this._seed+this._ctr,a=o[o.length-1];return a&&"function"==typeof a.postMessage&&(i=o.pop()),this.raw("request",{args:o,command:r,id:s},i),new this.Promise(function(t,e){n._pendingRequests[s]={args:o,command:r,id:s,reject:e,resolve:t}})}},{key:"respond",value:function(t,e,r,n){this.raw("response",{response:r,success:e,to:t},n)}}],[{key:"randomId",value:function(t){var e=t||16,r=[];if(window.crypto&&window.crypto.getRandomValues)r=window.crypto.getRandomValues(new Uint32Array(e));else if("object"===k(window.msCrypto)&&"function"==typeof window.msCrypto.getRandomValues)r=window.msCrypto.getRandomValues(new Uint32Array(e));else for(;r.length<e;)r.push(Math.floor(Math.random()*x.length));for(var n=[],o=0;o<e;o+=1)n.push(x[r[o]%x.length]);return n.join("")}}]),l}();I.PluginDisabled=f("PostMessageIO:PluginDisabled"),I.PluginDisabled.prototype.code=P,I.InvalidContext=f("PostMessageIO:InvalidContext"),I.InvalidContext.prototype.code=T,I.NotHandled=f("PostMessageIO:NotHandled"),I.NotHandled.prototype.code=R,I.UnsupportedCommand=f("PostMessageIO:UnsupportedCommand"),I.UnsupportedCommand.prototype.code=D;var B=I,N="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function U(t,e){return t(e={exports:{}},e.exports),e.exports}var M=U(function(t){var e=function(){return void 0===this}();if(e)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:e,propertyIsWritable:function(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!(r&&!r.writable&&!r.set)}};else{var n={}.hasOwnProperty,r={}.toString,o={}.constructor.prototype,i=function(t){var e=[];for(var r in t)n.call(t,r)&&e.push(r);return e};t.exports={isArray:function(t){try{return"[object Array]"===r.call(t)}catch(t){return!1}},keys:i,names:i,defineProperty:function(t,e,r){return t[e]=r.value,t},getDescriptor:function(t,e){return{value:t[e]}},freeze:function(t){return t},getPrototypeOf:function(t){try{return Object(t).constructor.prototype}catch(t){return o}},isES5:e,propertyIsWritable:function(){return!0}}}}),z=M.freeze,L=M.defineProperty,q=M.getDescriptor,H=M.keys,V=M.names,W=M.getPrototypeOf,K=M.isArray,$=M.isES5,Q=M.propertyIsWritable,J="undefined"==typeof navigator,G=function(){try{var t={};return M.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(t){return!1}}(),Y={e:{}},X;function Z(){try{var t=X;return X=null,t.apply(this,arguments)}catch(t){return Y.e=t,Y}}function tt(t){return X=t,Z}var et=function(e,r){var n={}.hasOwnProperty;function t(){for(var t in this.constructor=e,(this.constructor$=r).prototype)n.call(r.prototype,t)&&"$"!==t.charAt(t.length-1)&&(this[t+"$"]=r.prototype[t])}return t.prototype=r.prototype,e.prototype=new t,e.prototype};function rt(t){return null==t||!0===t||!1===t||"string"==typeof t||"number"==typeof t}function nt(t){return!rt(t)}function ot(t){return rt(t)?new Error(yt(t)):t}function it(t,e){var r,n=t.length,o=new Array(n+1);for(r=0;r<n;++r)o[r]=t[r];return o[r]=e,o}function st(t,e,r){if(!M.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var n=Object.getOwnPropertyDescriptor(t,e);return null!=n?null==n.get&&null==n.set?n.value:r:void 0}function at(t,e,r){if(rt(t))return t;var n={value:r,configurable:!0,enumerable:!1,writable:!0};return M.defineProperty(t,e,n),t}function ct(t){throw t}var ut=function(){var o=[Array.prototype,Object.prototype,Function.prototype],a=function(t){for(var e=0;e<o.length;++e)if(o[e]===t)return!0;return!1};if(M.isES5){var c=Object.getOwnPropertyNames;return function(t){for(var e=[],r=Object.create(null);null!=t&&!a(t);){var n;try{n=c(t)}catch(t){return e}for(var o=0;o<n.length;++o){var i=n[o];if(!r[i]){r[i]=!0;var s=Object.getOwnPropertyDescriptor(t,i);null!=s&&null==s.get&&null==s.set&&e.push(i)}}t=M.getPrototypeOf(t)}return e}}var i={}.hasOwnProperty;return function(t){if(a(t))return[];var e=[];t:for(var r in t)if(i.call(t,r))e.push(r);else{for(var n=0;n<o.length;++n)if(i.call(o[n],r))continue t;e.push(r)}return e}}(),lt=/this\s*\.\s*\S+\s*=/;function ht(t){try{if("function"==typeof t){var e=M.names(t.prototype),r=M.isES5&&1<e.length,n=0<e.length&&!(1===e.length&&"constructor"===e[0]),o=lt.test(t+"")&&0<M.names(t).length;if(r||n||o)return!0}return!1}catch(t){return!1}}function ft(t){return t}var pt=/^[a-z$_][a-z$_0-9]*$/i;function dt(t){return pt.test(t)}function vt(t,e,r){for(var n=new Array(t),o=0;o<t;++o)n[o]=e+o+r;return n}function yt(t){try{return t+""}catch(t){return"[no string representation]"}}function _t(t){try{at(t,"isOperational",!0)}catch(t){}}function gt(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||!0===t.isOperational)}function mt(t){return t instanceof Error&&M.propertyIsWritable(t,"stack")}var wt="stack"in new Error?function(t){return mt(t)?t:new Error(yt(t))}:function(t){if(mt(t))return t;try{throw new Error(yt(t))}catch(t){return t}};function bt(t){return{}.toString.call(t)}function kt(t,e,r){for(var n=M.names(t),o=0;o<n.length;++o){var i=n[o];if(r(i))try{M.defineProperty(e,i,M.getDescriptor(t,i))}catch(t){}}}var Et={isClass:ht,isIdentifier:dt,inheritedDataKeys:ut,getDataPropertyOrDefault:st,thrower:ct,isArray:M.isArray,haveGetters:G,notEnumerableProp:at,isPrimitive:rt,isObject:nt,canEvaluate:J,errorObj:Y,tryCatch:tt,inherits:et,withAppended:it,maybeWrapAsError:ot,toFastProperties:ft,filledRange:vt,toString:yt,canAttachTrace:mt,ensureErrorObject:wt,originatesFromRejection:gt,markAsOriginatingFromRejection:_t,classString:bt,copyDescriptors:kt,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof process&&"[object process]"===bt(process).toLowerCase()},Ct;Et.isRecentNode=Et.isNode&&(Ct=process.versions.node.split(".").map(Number),0===Ct[0]&&10<Ct[1]||0<Ct[0]),Et.isNode&&Et.toFastProperties(process);try{throw new Error}catch(t){Et.lastLineError=t}var jt=Et,At,Ft=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(jt.isNode&&"undefined"==typeof MutationObserver){var St=N.setImmediate,Ot=process.nextTick;At=jt.isRecentNode?function(t){St.call(N,t)}:function(t){Ot.call(process,t)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?At="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:Ft:(At=function(t){var e=document.createElement("div");return new MutationObserver(t).observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}},At.isStatic=!0);var xt=At;function Pt(t,e,r,n,o){for(var i=0;i<o;++i)r[i+n]=t[i+e],t[i+e]=void 0}function Tt(t){this._capacity=t,this._length=0,this._front=0}Tt.prototype._willBeOverCapacity=function(t){return this._capacity<t},Tt.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1),this[this._front+e&this._capacity-1]=t,this._length=e+1},Tt.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var r=(this._front-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},Tt.prototype.unshift=function(t,e,r){this._unshiftOne(r),this._unshiftOne(e),this._unshiftOne(t)},Tt.prototype.push=function(t,e,r){var n=this.length()+3;if(this._willBeOverCapacity(n))return this._pushOne(t),this._pushOne(e),void this._pushOne(r);var o=this._front+n-3;this._checkCapacity(n);var i=this._capacity-1;this[o+0&i]=t,this[o+1&i]=e,this[o+2&i]=r,this._length=n},Tt.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},Tt.prototype.length=function(){return this._length},Tt.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},Tt.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t,Pt(this,0,this,e,this._front+this._length&e-1)};var Rt=Tt,Dt;try{throw new Error}catch(t){Dt=t}var It=xt;function Bt(){this._isTickUsed=!1,this._lateQueue=new Rt(16),this._normalQueue=new Rt(16),this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=It.isStatic?It(this.drainQueues):It}function Nt(t,e,r){this._lateQueue.push(t,e,r),this._queueTick()}function Ut(t,e,r){this._normalQueue.push(t,e,r),this._queueTick()}function Mt(t){this._normalQueue._pushOne(t),this._queueTick()}Bt.prototype.disableTrampolineIfNecessary=function(){jt.hasDevTools&&(this._trampolineEnabled=!1)},Bt.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(t){setTimeout(t,0)})},Bt.prototype.haveItemsQueued=function(){return 0<this._normalQueue.length()},Bt.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(t){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},jt.hasDevTools?(It.isStatic&&(It=function(t){setTimeout(t,0)}),Bt.prototype.invokeLater=function(t,e,r){this._trampolineEnabled?Nt.call(this,t,e,r):this._schedule(function(){setTimeout(function(){t.call(e,r)},100)})},Bt.prototype.invoke=function(t,e,r){this._trampolineEnabled?Ut.call(this,t,e,r):this._schedule(function(){t.call(e,r)})},Bt.prototype.settlePromises=function(t){this._trampolineEnabled?Mt.call(this,t):this._schedule(function(){t._settlePromises()})}):(Bt.prototype.invokeLater=Nt,Bt.prototype.invoke=Ut,Bt.prototype.settlePromises=Mt),Bt.prototype.invokeFirst=function(t,e,r){this._normalQueue.unshift(t,e,r),this._queueTick()},Bt.prototype._drainQueue=function(t){for(;0<t.length();){var e=t.shift();if("function"==typeof e){var r=t.shift(),n=t.shift();e.call(r,n)}else e._settlePromises()}},Bt.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},Bt.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},Bt.prototype._reset=function(){this._isTickUsed=!1};var zt=new Bt,Lt=Dt;zt.firstLineError=Lt;var qt=M.freeze,Ht=jt.inherits,Vt=jt.notEnumerableProp,Wt,Kt;function $t(e,r){function n(t){if(!(this instanceof n))return new n(t);Vt(this,"message","string"==typeof t?t:r),Vt(this,"name",e),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this)}return Ht(n,Error),n}var Qt=$t("Warning","warning"),Jt=$t("CancellationError","cancellation error"),Gt=$t("TimeoutError","timeout error"),Yt=$t("AggregateError","aggregate error");try{Wt=TypeError,Kt=RangeError}catch(t){Wt=$t("TypeError","type error"),Kt=$t("RangeError","range error")}for(var Xt="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),Zt=0;Zt<Xt.length;++Zt)"function"==typeof Array.prototype[Xt[Zt]]&&(Yt.prototype[Xt[Zt]]=Array.prototype[Xt[Zt]]);M.defineProperty(Yt.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),Yt.prototype.isOperational=!0;var te=0;function ee(t){if(!(this instanceof ee))return new ee(t);Vt(this,"name","OperationalError"),Vt(this,"message",t),this.cause=t,this.isOperational=!0,t instanceof Error?(Vt(this,"message",t.message),Vt(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}Yt.prototype.toString=function(){var t=Array(4*te+1).join(" "),e="\n"+t+"AggregateError of:\n";te++,t=Array(4*te+1).join(" ");for(var r=0;r<this.length;++r){for(var n=this[r]===this?"[Circular AggregateError]":this[r]+"",o=n.split("\n"),i=0;i<o.length;++i)o[i]=t+o[i];e+=(n=o.join("\n"))+"\n"}return te--,e},Ht(ee,Error);var re=Error.__BluebirdErrorTypes__;re||(re=qt({CancellationError:Jt,TimeoutError:Gt,OperationalError:ee,RejectionError:ee,AggregateError:Yt}),Vt(Error,"__BluebirdErrorTypes__",re));var ne={Error:Error,TypeError:Wt,RangeError:Kt,CancellationError:re.CancellationError,OperationalError:re.OperationalError,TimeoutError:re.TimeoutError,AggregateError:re.AggregateError,Warning:Qt},oe=function(a,c){var u=jt,l=u.errorObj,i=u.isObject;function s(t){return t.then}var h={}.hasOwnProperty;return function(t,e){if(i(t)){if(t instanceof a)return t;if(o=t,h.call(o,"_promise0")){var r=new a(c);return t._then(r._fulfillUnchecked,r._rejectUncheckedCheckError,r._progressUnchecked,r,null),r}var n=u.tryCatch(s)(t);if(n===l)return e&&e._pushContext(),r=a.reject(n.e),e&&e._popContext(),r;if("function"==typeof n)return function(t,e,r){var n=new a(c),o=n;r&&r._pushContext(),n._captureStackTrace(),r&&r._popContext();var i=!0,s=u.tryCatch(e).call(t,function(t){n&&(n._resolveCallback(t),n=null)},function(t){n&&(n._rejectCallback(t,i,!0),n=null)},function(t){n&&"function"==typeof n._progress&&n._progress(t)});return i=!1,n&&s===l&&(n._rejectCallback(s.e,!0,!0),n=null),o}(t,n,e)}var o;return t}},ie=function(l,n,h,f){var p=jt.isArray;function t(t){var e,r=this._promise=new l(n);t instanceof l&&(e=t,r._propagateFrom(e,5)),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}return t.prototype.length=function(){return this._length},t.prototype.promise=function(){return this._promise},t.prototype._init=function t(e,r){var n=h(this._values,this._promise);if(n instanceof l){if(n=n._target(),!(this._values=n)._isFulfilled())return n._isPending()?void n._then(t,this._reject,void 0,this,r):void this._reject(n._reason());if(n=n._value(),!p(n)){var o=new l.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(o)}}else if(!p(n))return void this._promise._reject(f("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0!==n.length){var i=this.getActualLength(n.length);this._length=i,this._values=this.shouldCopyValues()?new Array(i):this._values;for(var s=this._promise,a=0;a<i;++a){var c=this._isResolved(),u=h(n[a],s);u instanceof l?(u=u._target(),c?u._ignoreRejections():u._isPending()?u._proxyPromiseArray(this,a):u._isFulfilled()?this._promiseFulfilled(u._value(),a):this._promiseRejected(u._reason(),a)):c||this._promiseFulfilled(u,a)}}else-5===r?this._resolveEmptyArray():this._resolve(function(t){switch(t){case-2:return[];case-3:return{}}}(r))},t.prototype._isResolved=function(){return null===this._values},t.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},t.prototype.__hardReject__=t.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1,!0)},t.prototype._promiseProgressed=function(t,e){this._promise._progress({index:e,value:t})},t.prototype._promiseFulfilled=function(t,e){this._values[e]=t,++this._totalResolved>=this._length&&this._resolve(this._values)},t.prototype._promiseRejected=function(t,e){this._totalResolved++,this._reject(t)},t.prototype.shouldCopyValues=function(){return!0},t.prototype.getActualLength=function(t){return t},t},se=function(){var o,a=zt,s=jt,l=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,c=null,i=null,u=!1;function h(t){this._parent=t;var e=this._length=1+(void 0===t?0:t._length);n(this,h),32<e&&this.uncycle()}function f(t){for(var e=[],r=0;r<t.length;++r){var n=t[r],o=c.test(n)||"    (No stack trace)"===n,i=o&&d(n);o&&!i&&(u&&" "!==n.charAt(0)&&(n="    "+n),e.push(n))}return e}function p(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();if(/\[object [a-zA-Z0-9$_]+\]/.test(e))try{e=JSON.stringify(t)}catch(t){}0===e.length&&(e="(empty array)")}return"(<"+function(t){if(t.length<41)return t;return t.substr(0,38)+"..."}(e)+">, no stack trace)"}s.inherits(h,Error),h.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],r={},n=0,o=this;void 0!==o;++n)e.push(o),o=o._parent;for(n=(t=this._length=n)-1;0<=n;--n){var i=e[n].stack;void 0===r[i]&&(r[i]=n)}for(n=0;n<t;++n){var s=r[e[n].stack];if(void 0!==s&&s!==n){0<s&&(e[s-1]._parent=void 0,e[s-1]._length=1),e[n]._parent=void 0,e[n]._length=1;var a=0<n?e[n-1]:this;a._length=s<t-1?(a._parent=e[s+1],a._parent.uncycle(),a._parent._length+1):(a._parent=void 0,1);for(var c=a._length+1,u=n-2;0<=u;--u)e[u]._length=c,c++;return}}}},h.prototype.parent=function(){return this._parent},h.prototype.hasParent=function(){return void 0!==this._parent},h.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=h.parseStackAndMessage(t),r=e.message,n=[e.stack],o=this;void 0!==o;)n.push(f(o.stack.split("\n"))),o=o._parent;!function(t){for(var e=t[0],r=1;r<t.length;++r){for(var n=t[r],o=e.length-1,i=e[o],s=-1,a=n.length-1;0<=a;--a)if(n[a]===i){s=a;break}for(var a=s;0<=a;--a){var c=n[a];if(e[o]!==c)break;e.pop(),o--}e=n}}(n),function(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}(n),s.notEnumerableProp(t,"stack",function(t,e){for(var r=0;r<e.length-1;++r)e[r].push("From previous event:"),e[r]=e[r].join("\n");r<e.length&&(e[r]=e[r].join("\n"));return t+"\n"+e.join("\n")}(r,n)),s.notEnumerableProp(t,"__stackCleaned__",!0)}},h.parseStackAndMessage=function(t){var e=t.stack;return{message:t.toString(),stack:f(e="string"==typeof e&&0<e.length?function(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),r=0;r<e.length;++r){var n=e[r];if("    (No stack trace)"===n||c.test(n))break}return 0<r&&(e=e.slice(r)),e}(t):["    (No stack trace)"])}},h.formatAndLogError=function(t,e){if("undefined"!=typeof console){var r;if("object"==typeof t||"function"==typeof t){var n=t.stack;r=e+i(n,t)}else r=e+String(t);"function"==typeof o?o(r):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(r)}},h.unhandledRejection=function(t){h.formatAndLogError(t,"^--- With additional stack trace: ")},h.isSupported=function(){return"function"==typeof n},h.fireRejectionEvent=function(t,e,r,n){var o=!1;try{"function"==typeof e&&(o=!0,"rejectionHandled"===t?e(n):e(r,n))}catch(t){a.throwLater(t)}var i=!1;try{i=_(t,r,n)}catch(t){i=!0,a.throwLater(t)}var s=!1;if(y)try{s=y(t.toLowerCase(),{reason:r,promise:n})}catch(t){s=!0,a.throwLater(t)}i||o||s||"unhandledRejection"!==t||h.formatAndLogError(r,"Unhandled rejection ")};var d=function(){return!1},r=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;function v(t){var e=t.match(r);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}h.setBounds=function(t,e){if(h.isSupported()){for(var r,n,o=t.stack.split("\n"),i=e.stack.split("\n"),s=-1,a=-1,c=0;c<o.length;++c){if(u=v(o[c])){r=u.fileName,s=u.line;break}}for(c=0;c<i.length;++c){var u;if(u=v(i[c])){n=u.fileName,a=u.line;break}}s<0||a<0||!r||!n||r!==n||a<=s||(d=function(t){if(l.test(t))return!0;var e=v(t);return!!(e&&e.fileName===r&&s<=e.line&&e.line<=a)})}};var y,n=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():p(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,c=t,i=e;var r=Error.captureStackTrace;return d=function(t){return l.test(t)},function(t,e){Error.stackTraceLimit=Error.stackTraceLimit+6,r(t,e),Error.stackTraceLimit=Error.stackTraceLimit-6}}var n,o=new Error;if("string"==typeof o.stack&&0<=o.stack.split("\n")[0].indexOf("stackDetection@"))return c=/@/,i=e,u=!0,function(t){t.stack=(new Error).stack};try{throw new Error}catch(t){n="stack"in t}return"stack"in o||!n||"number"!=typeof Error.stackTraceLimit?(i=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?p(e):e.toString()},null):(c=t,i=e,function(e){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(t){e.stack=t.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}(),_=function(){if(s.isNode)return function(t,e,r){return"rejectionHandled"===t?process.emit(t,r):process.emit(t,e,r)};var n=!1,e=!0;try{var t=new self.CustomEvent("test");n=t instanceof CustomEvent}catch(t){}if(!n)try{var r=document.createEvent("CustomEvent");r.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(r)}catch(t){e=!1}e&&(y=function(t,e){var r;return n?r=new self.CustomEvent(t,{detail:e,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(r=document.createEvent("CustomEvent")).initCustomEvent(t,!1,!0,e),!!r&&!self.dispatchEvent(r)});var i={};return i.unhandledRejection="onunhandledRejection".toLowerCase(),i.rejectionHandled="onrejectionHandled".toLowerCase(),function(t,e,r){var n=i[t],o=self[n];return!!o&&("rejectionHandled"===t?o.call(self,r):o.call(self,e,r),!0)}}();return"undefined"!=typeof console&&void 0!==console.warn&&(o=function(t){console.warn(t)},s.isNode&&process.stderr.isTTY?o=function(t){process.stderr.write("[31m"+t+"[39m\n")}:s.isNode||"string"!=typeof(new Error).stack||(o=function(t){console.warn("%c"+t,"color: red")})),h},ae=function(t,o){var r,n,i=t._getDomain,e=zt,s=ne.Warning,a=jt,c=a.canAttachTrace,u=a.isNode&&(!!process.env.BLUEBIRD_DEBUG||"development"===process.env.NODE_ENV);return a.isNode&&0==process.env.BLUEBIRD_DEBUG&&(u=!1),u&&e.disableTrampolineIfNecessary(),t.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},t.prototype._ensurePossibleRejectionHandled=function(){0==(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),e.invokeLater(this._notifyUnhandledRejection,this,void 0))},t.prototype._notifyUnhandledRejectionIsHandled=function(){o.fireRejectionEvent("rejectionHandled",r,void 0,this)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),o.fireRejectionEvent("unhandledRejection",n,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},t.prototype._isUnhandledRejectionNotified=function(){return 0<(524288&this._bitField)},t.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return 0<(2097152&this._bitField)},t.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},t.prototype._isCarryingStackTrace=function(){return 0<(1048576&this._bitField)},t.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},t.prototype._captureStackTrace=function(){return u&&(this._trace=new o(this._peekContext())),this},t.prototype._attachExtraTrace=function(t,e){if(u&&c(t)){var r=this._trace;if(void 0!==r&&e&&(r=r._parent),void 0!==r)r.attachExtraTrace(t);else if(!t.__stackCleaned__){var n=o.parseStackAndMessage(t);a.notEnumerableProp(t,"stack",n.message+"\n"+n.stack.join("\n")),a.notEnumerableProp(t,"__stackCleaned__",!0)}}},t.prototype._warn=function(t){var e=new s(t),r=this._peekContext();if(r)r.attachExtraTrace(e);else{var n=o.parseStackAndMessage(e);e.stack=n.message+"\n"+n.stack.join("\n")}o.formatAndLogError(e,"")},t.onPossiblyUnhandledRejection=function(t){var e=i();n="function"==typeof t?null===e?t:e.bind(t):void 0},t.onUnhandledRejectionHandled=function(t){var e=i();r="function"==typeof t?null===e?t:e.bind(t):void 0},t.longStackTraces=function(){if(e.haveItemsQueued()&&!1===u)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");(u=o.isSupported())&&e.disableTrampolineIfNecessary()},t.hasLongStackTraces=function(){return u&&o.isSupported()},o.isSupported()||(t.longStackTraces=function(){},u=!1),function(){return u}},ce=function(t,e,r){var n=[];function o(){this._trace=new e(i())}function i(){var t=n.length-1;if(0<=t)return n[t]}return o.prototype._pushContext=function(){r()&&void 0!==this._trace&&n.push(this._trace)},o.prototype._popContext=function(){r()&&void 0!==this._trace&&n.pop()},t.prototype._peekContext=i,t.prototype._pushContext=o.prototype._pushContext,t.prototype._popContext=o.prototype._popContext,function(){if(r())return new o}},ue=function(f){var t=jt,e=ne,p=t.tryCatch,d=t.errorObj,v=M.keys,y=e.TypeError;function r(t,e,r){this._instances=t,this._callback=e,this._promise=r}return r.prototype.doFilter=function(t){for(var e,r,n,o=this._callback,i=this._promise._boundValue(),s=0,a=this._instances.length;s<a;++s){var c=this._instances[s],u=c===Error||null!=c&&c.prototype instanceof Error;if(u&&t instanceof c)return(l=p(o).call(i,t))===d?(f.e=l.e,f):l;if("function"==typeof c&&!u){var l,h=(e=t,void 0,r={},(n=p(c).call(r,e))===d?n:v(r).length?(d.e=new y("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),d):n);if(h===d){t=d.e;break}if(h)return(l=p(o).call(i,t))===d?(f.e=l.e,f):l}}return f.e=t,f},r},le=jt.maybeWrapAsError,he=ne.TimeoutError,fe=ne.OperationalError,pe=jt.haveGetters;function de(t){return t instanceof Error&&M.getPrototypeOf(t)===Error.prototype}var ve=/^(?:name|message|stack|cause)$/,ye;function _e(t){var e;if(de(t)){(e=new fe(t)).name=t.name,e.message=t.message,e.stack=t.stack;for(var r=M.keys(t),n=0;n<r.length;++n){var o=r[n];ve.test(o)||(e[o]=t[o])}return e}return jt.markAsOriginatingFromRejection(t),t}function ge(s){return function(t,e){if(null!==s){if(t){var r=_e(le(t));s._attachExtraTrace(r),s._reject(r)}else if(2<arguments.length){for(var n=arguments.length,o=new Array(n-1),i=1;i<n;++i)o[i-1]=arguments[i];s._fulfill(o)}else s._fulfill(e);s=null}}}if(ye=pe?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=ge(t),this.callback=this.asCallback},pe){var me={get:function(){return ge(this.promise)}};M.defineProperty(ye.prototype,"asCallback",me),M.defineProperty(ye.prototype,"callback",me)}ye._nodebackForPromise=ge,ye.prototype.toString=function(){return"[object PromiseResolver]"},ye.prototype.resolve=ye.prototype.fulfill=function(t){if(!(this instanceof ye))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(t)},ye.prototype.reject=function(t){if(!(this instanceof ye))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(t)},ye.prototype.progress=function(t){if(!(this instanceof ye))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(t)},ye.prototype.cancel=function(t){this.promise.cancel(t)},ye.prototype.timeout=function(){this.reject(new he("timeout"))},ye.prototype.isResolved=function(){return this.promise.isResolved()},ye.prototype.toJSON=function(){return this.promise.toJSON()};var we=ye,be=function(a,c){var u=jt,l=zt,h=u.tryCatch,f=u.errorObj;a.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},a.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(t)},a.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},a.prototype._doProgressWith=function(t){var e=t.value,r=t.handler,n=t.promise,o=t.receiver,i=h(r).call(o,e);if(i===f){if(null!=i.e&&"StopProgressPropagation"!==i.e.name){var s=u.canAttachTrace(i.e)?i.e:new Error(u.toString(i.e));n._attachExtraTrace(s),n._progress(i.e)}}else i instanceof a?i._then(n._progress,null,null,n,void 0):n._progress(i)},a.prototype._progressUnchecked=function(t){for(var e=this._length(),r=this._progress,n=0;n<e;n++){var o=this._progressHandlerAt(n),i=this._promiseAt(n);if(i instanceof a)"function"==typeof o?l.invoke(this._doProgressWith,this,{handler:o,promise:i,receiver:this._receiverAt(n),value:t}):l.invoke(r,i,t);else{var s=this._receiverAt(n);"function"==typeof o?o.call(s,t,i):s instanceof c&&!s._isResolved()&&s._promiseProgressed(t,i)}}}},ke=function(i,s,t,a){var c=jt,u=c.tryCatch;i.method=function(r){if("function"!=typeof r)throw new i.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var t=new i(s);t._captureStackTrace(),t._pushContext();var e=u(r).apply(this,arguments);return t._popContext(),t._resolveFromSyncValue(e),t}},i.attempt=i.try=function(t,e,r){if("function"!=typeof t)return a("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var n=new i(s);n._captureStackTrace(),n._pushContext();var o=c.isArray(e)?u(t).apply(r,e):u(t).call(r,e);return n._popContext(),n._resolveFromSyncValue(o),n},i.prototype._resolveFromSyncValue=function(t){t===c.errorObj?this._rejectCallback(t.e,!1,!0):this._resolveCallback(t,!0)}},Ee=function(i,s,a){var r=function(t,e){this._reject(e)},c=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)},u=function(t,e){this._isPending()&&this._resolveCallback(e.target)},l=function(t,e){e.promiseRejectionQueued||this._reject(t)};i.prototype.bind=function(t){var e=a(t),r=new i(s);r._propagateFrom(this,1);var n=this._target();if(r._setBoundTo(e),e instanceof i){var o={promiseRejectionQueued:!1,promise:r,target:n,bindingPromise:e};n._then(s,c,r._progress,r,o),e._then(u,l,r._progress,r,o)}else r._resolveCallback(n);return r},i.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=131072|this._bitField,this._boundTo=t):this._bitField=-131073&this._bitField},i.prototype._isBound=function(){return 131072==(131072&this._bitField)},i.bind=function(t,e){var r=a(t),n=new i(s);return n._setBoundTo(r),r instanceof i?r._then(function(){n._resolveCallback(e)},n._reject,n._progress,n,null):n._resolveCallback(e),n}},Ce=function(i,s,a){var t=jt,c=t.isPrimitive,u=t.thrower;function l(){return this}function h(){throw this}function f(t,e,r){var n,o,i;return n=c(e)?r?(i=e,function(){return i}):(o=e,function(){throw o}):r?l:h,t._then(n,u,void 0,e,void 0)}function n(t){var e=this.promise,r=this.handler,n=e._isBound()?r.call(e._boundValue()):r();if(void 0!==n){var o=a(n,e);if(o instanceof i)return f(o=o._target(),t,e.isFulfilled())}return e.isRejected()?(s.e=t,s):t}function o(t){var e=this.promise,r=this.handler,n=e._isBound()?r.call(e._boundValue(),t):r(t);if(void 0!==n){var o=a(n,e);if(o instanceof i)return f(o=o._target(),t,!0)}return t}i.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var r={promise:this,handler:t};return this._then(e?n:o,e?n:void 0,void 0,r,void 0)},i.prototype.lastly=i.prototype.finally=function(t){return this._passThroughHandler(t,!0)},i.prototype.tap=function(t){return this._passThroughHandler(t,!1)}},je=jt.isPrimitive,Ae=function(e){var r=function(){return this},n=function(){throw this},o=function(){},i=function(){throw void 0},s=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};e.prototype.return=e.prototype.thenReturn=function(t){return void 0===t?this.then(o):je(t)?this._then(s(t,2),void 0,void 0,void 0,void 0):(t instanceof e&&t._ignoreRejections(),this._then(r,void 0,void 0,t,void 0))},e.prototype.throw=e.prototype.thenThrow=function(t){return void 0===t?this.then(i):je(t)?this._then(s(t,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,t,void 0)}},Fe=function(t){function e(t){this._settledValue=void 0!==t?(t=t._target(),this._bitField=t._bitField,t._settledValue):void(this._bitField=0)}e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},e.prototype.isFulfilled=t.prototype._isFulfilled=function(){return 0<(268435456&this._bitField)},e.prototype.isRejected=t.prototype._isRejected=function(){return 0<(134217728&this._bitField)},e.prototype.isPending=t.prototype._isPending=function(){return 0==(402653184&this._bitField)},e.prototype.isResolved=t.prototype._isResolved=function(){return 0<(402653184&this._bitField)},t.prototype.isPending=function(){return this._target()._isPending()},t.prototype.isRejected=function(){return this._target()._isRejected()},t.prototype.isFulfilled=function(){return this._target()._isFulfilled()},t.prototype.isResolved=function(){return this._target()._isResolved()},t.prototype._value=function(){return this._settledValue},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},t.prototype.value=function(){var t=this._target();if(!t.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return t._settledValue},t.prototype.reason=function(){var t=this._target();if(!t.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return t._unsetRejectionIsUnhandled(),t._settledValue},t.PromiseInspection=e},Se=function(l,h,f,p){var t=jt,d=t.canEvaluate,i=t.tryCatch,s=t.errorObj;if(d){for(var e=function(t){for(var e=[],r=1;r<=t;++r)e.push("holder.p"+r);return new Function("holder","                                      \n            'use strict';                                                    \n            var callback = holder.fn;                                        \n            return callback(values);                                         \n            ".replace(/values/g,e.join(", ")))},v=[],r=[void 0],n=1;n<=5;++n)v.push(new Function("value","holder","                             \n            'use strict';                                                    \n            holder.pIndex = value;                                           \n            holder.checkFulfillment(this);                                   \n            ".replace(/Index/g,n))),r.push(e(n));var y=function(t,e){this.p1=this.p2=this.p3=this.p4=this.p5=null,this.fn=e,this.total=t,this.now=0};y.prototype.callers=r,y.prototype.checkFulfillment=function(t){var e=this.now;e++;var r=this.total;if(r<=e){var n=this.callers[r];t._pushContext();var o=i(n)(this);t._popContext(),o===s?t._rejectCallback(o.e,!1,!0):t._resolveCallback(o)}else this.now=e};var _=function(t){this._reject(t)}}l.join=function(){var t,e=arguments.length-1;if(0<e&&"function"==typeof arguments[e]&&(t=arguments[e],e<6&&d)){(u=new l(p))._captureStackTrace();for(var r=new y(e,t),n=v,o=0;o<e;++o){var i=f(arguments[o],u);i instanceof l?(i=i._target())._isPending()?i._then(n[o],_,void 0,u,r):i._isFulfilled()?n[o].call(u,i._value(),r):u._reject(i._reason()):n[o].call(u,i,r)}return u}for(var s=arguments.length,a=new Array(s),c=0;c<s;++c)a[c]=arguments[c];t&&a.pop();var u=new h(a).promise();return void 0!==t?u.spread(t):u}},Oe=function(l,t,o,h,i){var s=l._getDomain,a=zt,e=jt,f=e.tryCatch,p=e.errorObj,d={},c=[];function u(t,e,r,n){this.constructor$(t),this._promise._captureStackTrace();var o=s();this._callback=null===o?e:o.bind(e),this._preservedValues=n===i?new Array(this.length()):null,this._limit=r,this._inFlight=0,this._queue=1<=r?[]:c,a.invoke(v,this,void 0)}function v(){this._init$(void 0,-2)}function y(t,e,r,n){var o="object"==typeof r&&null!==r?r.concurrency:0;return new u(t,e,o="number"==typeof o&&isFinite(o)&&1<=o?o:0,n)}e.inherits(u,t),u.prototype._init=function(){},u.prototype._promiseFulfilled=function(t,e){var r=this._values,n=this.length(),o=this._preservedValues,i=this._limit;if(r[e]===d){if(r[e]=t,1<=i&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(1<=i&&this._inFlight>=i)return r[e]=t,void this._queue.push(e);null!==o&&(o[e]=t);var s=this._callback,a=this._promise._boundValue();this._promise._pushContext();var c=f(s).call(a,t,e,n);if(this._promise._popContext(),c===p)return this._reject(c.e);var u=h(c,this._promise);if(u instanceof l){if((u=u._target())._isPending())return 1<=i&&this._inFlight++,r[e]=d,u._proxyPromiseArray(this,e);if(!u._isFulfilled())return this._reject(u._reason());c=u._value()}r[e]=c}n<=++this._totalResolved&&(null!==o?this._filter(r,o):this._resolve(r))},u.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,r=this._values;0<t.length&&this._inFlight<e;){if(this._isResolved())return;var n=t.pop();this._promiseFulfilled(r[n],n)}},u.prototype._filter=function(t,e){for(var r=e.length,n=new Array(r),o=0,i=0;i<r;++i)t[i]&&(n[o++]=e[i]);n.length=o,this._resolve(n)},u.prototype.preservedValues=function(){return this._preservedValues},l.prototype.map=function(t,e){return"function"!=typeof t?o("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):y(this,t,e,null).promise()},l.map=function(t,e,r,n){return"function"!=typeof e?o("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):y(t,e,r,n).promise()}},xe=function(t){var e=zt,r=ne.CancellationError;t.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,r=this;void 0!==(e=r._cancellationParent)&&e.isCancellable();)r=e;this._unsetCancellable(),r._target()._rejectCallback(t,!1,!0)},t.prototype.cancel=function(t){return this.isCancellable()&&(void 0===t&&(t=new r),e.invokeLater(this._cancel,this,t)),this},t.prototype.cancellable=function(){return this._cancellable()||(e.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0),this},t.prototype.uncancellable=function(){var t=this.then();return t._unsetCancellable(),t},t.prototype.fork=function(t,e,r){var n=this._then(t,e,r,void 0,void 0);return n._setCancellable(),n._cancellationParent=void 0,n}},Pe=function(l,h,f,e){var r=ne.TypeError,t=jt.inherits,n=l.PromiseInspection;function p(t){for(var e=t.length,r=0;r<e;++r){var n=t[r];if(n.isRejected())return l.reject(n.error());t[r]=n._settledValue}return t}function u(t){setTimeout(function(){throw t},0)}function o(o,i){var s=0,a=o.length,c=l.defer();return function t(){if(a<=s)return c.resolve();var e,r,n=(e=o[s++],(r=f(e))!==e&&"function"==typeof e._isDisposable&&"function"==typeof e._getDisposer&&e._isDisposable()&&r._setDisposable(e._getDisposer()),r);if(n instanceof l&&n._isDisposable()){try{n=f(n._getDisposer().tryDispose(i),o.promise)}catch(t){return u(t)}if(n instanceof l)return n._then(t,u,null,null,null)}t()}(),c.promise}function d(t){var e=new n;return e._settledValue=t,e._bitField=268435456,o(this,e).thenReturn(t)}function v(t){var e=new n;return e._settledValue=t,e._bitField=134217728,o(this,e).thenThrow(t)}function y(t,e,r){this._data=t,this._promise=e,this._context=r}function i(t,e,r){this.constructor$(t,e,r)}function _(t){return y.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}y.prototype.data=function(){return this._data},y.prototype.promise=function(){return this._promise},y.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},y.prototype.tryDispose=function(t){var e=this.resource(),r=this._context;void 0!==r&&r._pushContext();var n=null!==e?this.doDispose(e,t):null;return void 0!==r&&r._popContext(),this._promise._unsetDisposable(),this._data=null,n},y.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},t(i,y),i.prototype.doDispose=function(t,e){return this.data().call(t,t,e)},l.using=function(){var t=arguments.length;if(t<2)return h("you must pass at least 2 arguments to Promise.using");var e,r=arguments[t-1];if("function"!=typeof r)return h("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var n=!0;2===t&&Array.isArray(arguments[0])?(t=(e=arguments[0]).length,n=!1):(e=arguments,t--);for(var o=new Array(t),i=0;i<t;++i){var s=e[i];if(y.isDisposer(s)){var a=s;(s=s.promise())._setDisposable(a)}else{var c=f(s);c instanceof l&&(s=c._then(_,null,null,{resources:o,index:i},void 0))}o[i]=s}var u=l.settle(o).then(p).then(function(t){var e;u._pushContext();try{e=n?r.apply(void 0,t):r.call(void 0,t)}finally{u._popContext()}return e})._then(d,v,void 0,o,void 0);return o.promise=u},l.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},l.prototype._isDisposable=function(){return 0<(262144&this._bitField)},l.prototype._getDisposer=function(){return this._disposer},l.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},l.prototype.disposer=function(t){if("function"==typeof t)return new i(t,this,e());throw new r}},Te=function(a,n,o,c){var s=ne.TypeError,t=jt,u=t.errorObj,l=t.tryCatch,i=[];function h(t,e,r,n){(this._promise=new a(o))._captureStackTrace(),this._stack=n,this._generatorFunction=t,this._receiver=e,this._generator=void 0,this._yieldHandlers="function"==typeof r?[r].concat(i):i}h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},h.prototype._continue=function(t){if(t===u)return this._promise._rejectCallback(t.e,!1,!0);var e=t.value;if(!0===t.done)this._promise._resolveCallback(e);else{var r=c(e,this._promise);if(!(r instanceof a)&&null===(r=function(t,e,r){for(var n=0;n<e.length;++n){r._pushContext();var o=l(e[n])(t);if(r._popContext(),o===u){r._pushContext();var i=a.reject(u.e);return r._popContext(),i}var s=c(o,r);if(s instanceof a)return s}return null}(r,this._yieldHandlers,this._promise)))return void this._throw(new s("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",e)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r._then(this._next,this._throw,void 0,this,null)}},h.prototype._throw=function(t){this._promise._attachExtraTrace(t),this._promise._pushContext();var e=l(this._generator.throw).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._next=function(t){this._promise._pushContext();var e=l(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},a.coroutine=function(r,t){if("function"!=typeof r)throw new s("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=Object(t).yieldHandler,o=h,i=(new Error).stack;return function(){var t=r.apply(this,arguments),e=new o(void 0,void 0,n,i);return e._generator=t,e._next(void 0),e.promise()}},a.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new s("fn must be a function\n\n    See http://goo.gl/916lJJ\n");i.push(t)},a.spawn=function(t){if("function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var e=new h(t,this),r=e.promise();return e._run(a.spawn),r}},Re=function(t){var n=jt,o=zt,i=n.tryCatch,s=n.errorObj;function a(t,e){if(!n.isArray(t))return c.call(this,t,e);var r=i(e).apply(this._boundValue(),[null].concat(t));r===s&&o.throwLater(r.e)}function c(t,e){var r=this._boundValue(),n=void 0===t?i(e).call(r,null):i(e).call(r,null,t);n===s&&o.throwLater(n.e)}function u(t,e){if(!t){var r=this._target()._getCarriedStackTrace();r.cause=t,t=r}var n=i(e).call(this._boundValue(),t);n===s&&o.throwLater(n.e)}t.prototype.asCallback=t.prototype.nodeify=function(t,e){if("function"==typeof t){var r=c;void 0!==e&&Object(e).spread&&(r=a),this._then(r,u,void 0,this,t)}return this}},De=Object.create;if(De){var Ie=De(null),Be=De(null);Ie[" size"]=Be[" size"]=0}var Ne=function(o){var i,n,s=jt,a=s.canEvaluate,c=s.isIdentifier,e=function(t){return new Function("ensureMethod","                                    \n        return function(obj) {                                               \n            'use strict'                                                     \n            var len = this.length;                                           \n            ensureMethod(obj, 'methodName');                                 \n            switch(len) {                                                    \n                case 1: return obj.methodName(this[0]);                      \n                case 2: return obj.methodName(this[0], this[1]);             \n                case 3: return obj.methodName(this[0], this[1], this[2]);    \n                case 0: return obj.methodName();                             \n                default:                                                     \n                    return obj.methodName.apply(obj, this);                  \n            }                                                                \n        };                                                                   \n        ".replace(/methodName/g,t))(l)},r=function(t){return new Function("obj","                                             \n        'use strict';                                                        \n        return obj.propertyName;                                             \n        ".replace("propertyName",t))},u=function(t,e,r){var n=r[t];if("function"!=typeof n){if(!c(t))return null;if(n=e(t),r[t]=n,r[" size"]++,512<r[" size"]){for(var o=Object.keys(r),i=0;i<256;++i)delete r[o[i]];r[" size"]=o.length-256}}return n};function l(t,e){var r;if(null!=t&&(r=t[e]),"function"==typeof r)return r;var n="Object "+s.classString(t)+" has no method '"+s.toString(e)+"'";throw new o.TypeError(n)}function h(t){return l(t,this.pop()).apply(t,this)}function f(t){return t[this]}function p(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}i=function(t){return u(t,e,Ie)},n=function(t){return u(t,r,Be)},o.prototype.call=function(t){for(var e=arguments.length,r=new Array(e-1),n=1;n<e;++n)r[n-1]=arguments[n];if(a){var o=i(t);if(null!==o)return this._then(o,void 0,void 0,r,void 0)}return r.push(t),this._then(h,void 0,void 0,r,void 0)},o.prototype.get=function(t){var e;if("number"==typeof t)e=p;else if(a){var r=n(t);e=null!==r?r:f}else e=f;return this._then(e,void 0,void 0,t,void 0)}},Ue=function(n,t,o,i){var e=jt,s=e.isObject,a=M;function c(t){for(var e=a.keys(t),r=e.length,n=new Array(2*r),o=0;o<r;++o){var i=e[o];n[o]=t[i],n[o+r]=i}this.constructor$(n)}function r(t){var e,r=o(t);return s(r)?(e=r instanceof n?r._then(n.props,void 0,void 0,void 0,void 0):new c(r).promise(),r instanceof n&&e._propagateFrom(r,4),e):i("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}e.inherits(c,t),c.prototype._init=function(){this._init$(void 0,-3)},c.prototype._promiseFulfilled=function(t,e){if(this._values[e]=t,++this._totalResolved>=this._length){for(var r={},n=this.length(),o=0,i=this.length();o<i;++o)r[this._values[o+n]]=this._values[o];this._resolve(r)}},c.prototype._promiseProgressed=function(t,e){this._promise._progress({key:this._values[e+this.length()],value:t})},c.prototype.shouldCopyValues=function(){return!1},c.prototype.getActualLength=function(t){return t>>1},n.prototype.props=function(){return r(this)},n.props=function(t){return r(t)}},Me=function(u,l,h,f){var p=jt.isArray,d=function(e){return e.then(function(t){return r(t,e)})};function r(t,e){var r=h(t);if(r instanceof u)return d(r);if(!p(t))return f("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var n=new u(l);void 0!==e&&n._propagateFrom(e,5);for(var o=n._fulfill,i=n._reject,s=0,a=t.length;s<a;++s){var c=t[s];(void 0!==c||s in t)&&u.cast(c)._then(o,i,void 0,n,null)}return n}u.race=function(t){return r(t,void 0)},u.prototype.race=function(){return r(this,void 0)}},ze=function(d,t,o,v,c){var u=d._getDomain,l=zt,e=jt,y=e.tryCatch,_=e.errorObj;function i(t,e,r,n){this.constructor$(t),this._promise._captureStackTrace(),this._preservedValues=n===c?[]:null,this._zerothIsAccum=void 0===r,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var o=v(r,this._promise),i=!1,s=o instanceof d;s&&((o=o._target())._isPending()?o._proxyPromiseArray(this,-1):o._isFulfilled()?(r=o._value(),this._gotAccum=!0):(this._reject(o._reason()),i=!0)),s||this._zerothIsAccum||(this._gotAccum=!0);var a=u();this._callback=null===a?e:a.bind(e),this._accum=r,i||l.invoke(h,this,void 0)}function h(){this._init$(void 0,-5)}function s(t,e,r,n){return"function"!=typeof e?o("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):new i(t,e,r,n).promise()}e.inherits(i,t),i.prototype._init=function(){},i.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},i.prototype._promiseFulfilled=function(t,e){var r=this._values;r[e]=t;var n,o=this.length(),i=this._preservedValues,s=null!==i,a=this._gotAccum,c=this._valuesPhase;if(!c)for(c=this._valuesPhase=new Array(o),n=0;n<o;++n)c[n]=0;if(n=c[e],0===e&&this._zerothIsAccum?(this._accum=t,this._gotAccum=a=!0,c[e]=0===n?1:2):-1===e?(this._accum=t,this._gotAccum=a=!0):0===n?c[e]=1:(c[e]=2,this._accum=t),a){for(var u,l=this._callback,h=this._promise._boundValue(),f=this._reducingIndex;f<o;++f)if(2!==(n=c[f])){if(1!==n)return;if(t=r[f],this._promise._pushContext(),u=s?(i.push(t),y(l).call(h,t,f,o)):y(l).call(h,this._accum,t,f,o),this._promise._popContext(),u===_)return this._reject(u.e);var p=v(u,this._promise);if(p instanceof d){if((p=p._target())._isPending())return c[f]=4,p._proxyPromiseArray(this,f);if(!p._isFulfilled())return this._reject(p._reason());u=p._value()}this._reducingIndex=f+1,this._accum=u}else this._reducingIndex=f+1;this._resolve(s?i:this._accum)}},d.prototype.reduce=function(t,e){return s(this,t,e,null)},d.reduce=function(t,e,r,n){return s(t,e,r,n)}},Le=function(t,e){var n=t.PromiseInspection;function r(t){this.constructor$(t)}jt.inherits(r,e),r.prototype._promiseResolved=function(t,e){this._values[t]=e,++this._totalResolved>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(t,e){var r=new n;r._bitField=268435456,r._settledValue=t,this._promiseResolved(e,r)},r.prototype._promiseRejected=function(t,e){var r=new n;r._bitField=134217728,r._settledValue=t,this._promiseResolved(e,r)},t.settle=function(t){return new r(t).promise()},t.prototype.settle=function(){return new r(this).promise()}},qe=function(t,e,o){var r=jt,n=ne.RangeError,i=ne.AggregateError,s=r.isArray;function a(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function c(t,e){if((0|e)!==e||e<0)return o("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var r=new a(t),n=r.promise();return r.setHowMany(e),r.init(),n}r.inherits(a,e),a.prototype._init=function(){if(this._initialized)if(0!==this._howMany){this._init$(void 0,-5);var t=s(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}else this._resolve([])},a.prototype.init=function(){this._initialized=!0,this._init()},a.prototype.setUnwrap=function(){this._unwrap=!0},a.prototype.howMany=function(){return this._howMany},a.prototype.setHowMany=function(t){this._howMany=t},a.prototype._promiseFulfilled=function(t){this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},a.prototype._promiseRejected=function(t){if(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()){for(var e=new i,r=this.length();r<this._values.length;++r)e.push(this._values[r]);this._reject(e)}},a.prototype._fulfilled=function(){return this._totalResolved},a.prototype._rejected=function(){return this._values.length-this.length()},a.prototype._addRejected=function(t){this._values.push(t)},a.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},a.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},a.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new n(e)},a.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return c(t,e)},t.prototype.some=function(t){return c(this,t)},t._SomePromiseArray=a},He=function(h,f){var p={},d=jt,v=we._nodebackForPromise,y=d.withAppended,_=d.maybeWrapAsError,t=d.canEvaluate,g=ne.TypeError,m={__isPromisified__:!0},e=new RegExp("^(?:"+["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"].join("|")+")$"),w=function(t){return d.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t};function i(t){return!e.test(t)}function b(t){try{return!0===t.__isPromisified__}catch(t){return!1}}function k(t,e,r,n){for(var o,i,s,a,c=d.inheritedDataKeys(t),u=[],l=0;l<c.length;++l){var h=c[l],f=t[h],p=n===w||w(h,f,t);"function"!=typeof f||b(f)||(o=t,i=h,s=e,void 0,(a=d.getDataPropertyOrDefault(o,i+s,m))&&b(a))||!n(h,f,t,p)||u.push(h,f)}return function(t,e,r){for(var n=0;n<t.length;n+=2){var o=t[n];if(r.test(o))for(var i=o.replace(r,""),s=0;s<t.length;s+=2)if(t[s]===i)throw new g("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",e))}}(u,e,r),u}var E=function(t){return t.replace(/([$])/,"\\$")};var C=t?function(t,o,e,r){var n,i=Math.max(0,("number"==typeof(n=r).length?Math.max(Math.min(n.length,1024),0):0)-1),s=function(t){for(var e=[t],r=Math.max(0,t-1-3),n=t-1;r<=n;--n)e.push(n);for(n=t+1;n<=3;++n)e.push(n);return e}(i),a="string"==typeof t||o===p;function c(t){var e,r=(e=t,d.filledRange(e,"_arg","")).join(", "),n=0<t?", ":"";return(a?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===o?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n").replace("{{args}}",r).replace(", ",n)}var u,l="string"==typeof t?"this != null ? this['"+t+"'] : fn":"fn";return new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL","'use strict';                            \n        var ret = function (Parameters) {                                    \n            'use strict';                                                    \n            var len = arguments.length;                                      \n            var promise = new Promise(INTERNAL);                             \n            promise._captureStackTrace();                                    \n            var nodeback = nodebackForPromise(promise);                      \n            var ret;                                                         \n            var callback = tryCatch([GetFunctionCode]);                      \n            switch(len) {                                                    \n                [CodeForSwitchCase]                                          \n            }                                                                \n            if (ret === errorObj) {                                          \n                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n            }                                                                \n            return promise;                                                  \n        };                                                                   \n        notEnumerableProp(ret, '__isPromisified__', true);                   \n        return ret;                                                          \n        ".replace("Parameters",(u=i,d.filledRange(Math.max(u,3),"_arg",""))).replace("[CodeForSwitchCase]",function(){for(var t="",e=0;e<s.length;++e)t+="case "+s[e]+":"+c(s[e]);return t+="                                                             \n        default:                                                             \n            var args = new Array(len + 1);                                   \n            var i = 0;                                                       \n            for (var i = 0; i < len; ++i) {                                  \n               args[i] = arguments[i];                                       \n            }                                                                \n            args[i] = nodeback;                                              \n            [CodeForCall]                                                    \n            break;                                                           \n        ".replace("[CodeForCall]",a?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}()).replace("[GetFunctionCode]",l))(h,r,o,y,_,v,d.tryCatch,d.errorObj,d.notEnumerableProp,f)}:function(o,i,t,e){var s=function(){return this}(),a=o;function r(){var t=i;i===p&&(t=this);var e=new h(f);e._captureStackTrace();var r="string"==typeof a&&this!==s?this[a]:o,n=v(e);try{r.apply(t,y(arguments,n))}catch(t){e._rejectCallback(_(t),!0,!0)}return e}return"string"==typeof a&&(o=e),d.notEnumerableProp(r,"__isPromisified__",!0),r};function c(t,e,r,n){for(var o=new RegExp(E(e)+"$"),i=k(t,e,o,r),s=0,a=i.length;s<a;s+=2){var c=i[s],u=i[s+1],l=c+e;if(n===C)t[l]=C(c,p,c,u,e);else{var h=n(u,function(){return C(c,p,c,u,e)});d.notEnumerableProp(h,"__isPromisified__",!0),t[l]=h}}return d.toFastProperties(t),t}h.promisify=function(t,e){if("function"!=typeof t)throw new g("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(b(t))return t;var r,n,o=(r=t,n=arguments.length<2?p:e,C(r,n,void 0,r));return d.copyDescriptors(t,o,i),o},h.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new g("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");var r=(e=Object(e)).suffix;"string"!=typeof r&&(r="Async");var n=e.filter;"function"!=typeof n&&(n=w);var o=e.promisifier;if("function"!=typeof o&&(o=C),!d.isIdentifier(r))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var i=d.inheritedDataKeys(t),s=0;s<i.length;++s){var a=t[i[s]];"constructor"!==i[s]&&d.isClass(a)&&(c(a.prototype,r,n,o),c(a,r,n,o))}return c(t,r,n,o)}},Ve=function(t){var n=t._SomePromiseArray;function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}},We=function(t,r){var n=t.reduce;t.prototype.each=function(t){return n(this,t,null,r)},t.each=function(t,e){return n(t,e,null,r)}},Ke=function(n,o){var i=jt,s=n.TimeoutError,a=function(t){return e(+this).thenReturn(t)},e=n.delay=function(t,e){if(void 0!==e)return e=+e,n.resolve(t)._then(a,null,null,e,void 0);e=t,t=void 0;var r=new n(o);return setTimeout(function(){r._fulfill()},e),r};function r(t){var e=this;return e instanceof Number&&(e=+e),clearTimeout(e),t}function c(t){var e=this;throw e instanceof Number&&(e=+e),clearTimeout(e),t}n.prototype.delay=function(t){return e(this,t)},n.prototype.timeout=function(t,n){t=+t;var o=this.then().cancellable();o._cancellationParent=this;var e=setTimeout(function(){var t,e,r;e=n,(t=o).isPending()&&(r=!i.isPrimitive(e)&&e instanceof Error?e:("string"!=typeof e&&(e="operation timed out"),new s(e)),i.markAsOriginatingFromRejection(r),t._attachExtraTrace(r),t._cancel(r))},t);return o._then(r,c,void 0,e,void 0)}},$e=function(t,n){var o=t.map;t.prototype.filter=function(t,e){return o(this,t,e,n)},t.filter=function(t,e,r){return o(t,e,r,n)}},Qe=U(function(C){C.exports=function(){var u,a=function(){return new h("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},t=function(){return new k.PromiseInspection(this._target())},e=function(t){return k.reject(new h(t))},i=jt;u=i.isNode?function(){var t=process.domain;return void 0===t&&(t=null),t}:function(){return null},i.notEnumerableProp(k,"_getDomain",u);var c={},l=zt,r=ne,h=k.TypeError=r.TypeError;k.RangeError=r.RangeError,k.CancellationError=r.CancellationError,k.TimeoutError=r.TimeoutError,k.OperationalError=r.OperationalError,k.RejectionError=r.OperationalError,k.AggregateError=r.AggregateError;var f=function(){},s={},p={e:null},d=oe(k,f),v=ie(k,f,d,e),n=se(),o=ae(k,n),y=ce(k,n,o),_=ue(p),g=we,m=g._nodebackForPromise,w=i.errorObj,b=i.tryCatch;function k(t){if("function"!=typeof t)throw new h("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==k)throw new h("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,t!==f&&this._resolveFromResolver(t)}function E(t){var e=new k(f);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._progressHandler0=t,e._promise0=t,e._receiver0=t,e._settledValue=t}return k.prototype.toString=function(){return"[object Promise]"},k.prototype.caught=k.prototype.catch=function(t){var e=arguments.length;if(1<e){var r,n=new Array(e-1),o=0;for(r=0;r<e-1;++r){var i=arguments[r];if("function"!=typeof i)return k.reject(new h("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));n[o++]=i}n.length=o,t=arguments[r];var s=new _(n,t,this);return this._then(void 0,s.doFilter,void 0,s,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},k.prototype.reflect=function(){return this._then(t,t,void 0,this,void 0)},k.prototype.then=function(t,e,r){if(o()&&0<arguments.length&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+i.classString(t);1<arguments.length&&(n+=", "+i.classString(e)),this._warn(n)}return this._then(t,e,r,void 0,void 0)},k.prototype.done=function(t,e,r){this._then(t,e,r,void 0,void 0)._setIsFinal()},k.prototype.spread=function(t,e){return this.all()._then(t,e,void 0,s,void 0)},k.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},k.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},k.prototype.all=function(){return new v(this).promise()},k.prototype.error=function(t){return this.caught(i.originatesFromRejection,t)},k.getNewLibraryCopy=C.exports,k.is=function(t){return t instanceof k},k.fromNode=function(t){var e=new k(f),r=b(t)(m(e));return r===w&&e._rejectCallback(r.e,!0,!0),e},k.all=function(t){return new v(t).promise()},k.defer=k.pending=function(){var t=new k(f);return new g(t)},k.resolve=k.fulfilled=k.cast=function(t){var e=d(t);if(!(e instanceof k)){var r=e;(e=new k(f))._fulfillUnchecked(r)}return e},k.reject=k.rejected=function(t){var e=new k(f);return e._captureStackTrace(),e._rejectCallback(t,!0),e},k.setScheduler=function(t){if("function"!=typeof t)throw new h("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var e=l._schedule;return l._schedule=t,e},k.prototype._then=function(t,e,r,n,o){var i=void 0!==o,s=i?o:new k(f);i||(s._propagateFrom(this,5),s._captureStackTrace());var a=this._target();a!==this&&(void 0===n&&(n=this._boundTo),i||s._setIsMigrated());var c=a._addCallbacks(t,e,r,s,n,u());return a._isResolved()&&!a._isSettlePromisesQueued()&&l.invoke(a._settlePromiseAtPostResolution,a,c),s},k.prototype._settlePromiseAtPostResolution=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(t)},k.prototype._length=function(){return 131071&this._bitField},k.prototype._isFollowingOrFulfilledOrRejected=function(){return 0<(939524096&this._bitField)},k.prototype._isFollowing=function(){return 536870912==(536870912&this._bitField)},k.prototype._setLength=function(t){this._bitField=-131072&this._bitField|131071&t},k.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},k.prototype._setRejected=function(){this._bitField=134217728|this._bitField},k.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},k.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},k.prototype._isFinal=function(){return 0<(33554432&this._bitField)},k.prototype._cancellable=function(){return 0<(67108864&this._bitField)},k.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},k.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},k.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},k.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},k.prototype._isMigrated=function(){return 0<(4194304&this._bitField)},k.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[5*t-5+4];if(e!==c)return void 0===e&&this._isBound()?this._boundValue():e},k.prototype._promiseAt=function(t){return 0===t?this._promise0:this[5*t-5+3]},k.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[5*t-5+0]},k.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[5*t-5+1]},k.prototype._boundValue=function(){var t=this._boundTo;return void 0!==t&&t instanceof k?t.isFulfilled()?t.value():void 0:t},k.prototype._migrateCallbacks=function(t,e){var r=t._fulfillmentHandlerAt(e),n=t._rejectionHandlerAt(e),o=t._progressHandlerAt(e),i=t._promiseAt(e),s=t._receiverAt(e);i instanceof k&&i._setIsMigrated(),void 0===s&&(s=c),this._addCallbacks(r,n,o,i,s,null)},k.prototype._addCallbacks=function(t,e,r,n,o,i){var s=this._length();if(131066<=s&&(s=0,this._setLength(0)),0===s)this._promise0=n,void 0!==o&&(this._receiver0=o),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===i?t:i.bind(t)),"function"==typeof e&&(this._rejectionHandler0=null===i?e:i.bind(e)),"function"==typeof r&&(this._progressHandler0=null===i?r:i.bind(r));else{var a=5*s-5;this[a+3]=n,this[a+4]=o,"function"==typeof t&&(this[a+0]=null===i?t:i.bind(t)),"function"==typeof e&&(this[a+1]=null===i?e:i.bind(e)),"function"==typeof r&&(this[a+2]=null===i?r:i.bind(r))}return this._setLength(s+1),s},k.prototype._setProxyHandlers=function(t,e){var r=this._length();if(131066<=r&&(r=0,this._setLength(0)),0===r)this._promise0=e,this._receiver0=t;else{var n=5*r-5;this[n+3]=e,this[n+4]=t}this._setLength(r+1)},k.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},k.prototype._resolveCallback=function(t,e){if(!this._isFollowingOrFulfilledOrRejected()){if(t===this)return this._rejectCallback(a(),!1,!0);var r=d(t,this);if(!(r instanceof k))return this._fulfill(t);var n=1|(e?4:0);this._propagateFrom(r,n);var o=r._target();if(o._isPending()){for(var i=this._length(),s=0;s<i;++s)o._migrateCallbacks(this,s);this._setFollowing(),this._setLength(0),this._setFollowee(o)}else o._isFulfilled()?this._fulfillUnchecked(o._value()):this._rejectUnchecked(o._reason(),o._getCarriedStackTrace())}},k.prototype._rejectCallback=function(t,e,r){r||i.markAsOriginatingFromRejection(t);var n=i.ensureErrorObject(t),o=n===t;this._attachExtraTrace(n,!!e&&o),this._reject(t,o?void 0:n)},k.prototype._resolveFromResolver=function(t){var e=this;this._captureStackTrace(),this._pushContext();var r=!0,n=b(t)(function(t){null!==e&&(e._resolveCallback(t),e=null)},function(t){null!==e&&(e._rejectCallback(t,r),e=null)});r=!1,this._popContext(),void 0!==n&&n===w&&null!==e&&(e._rejectCallback(n.e,!0,!0),e=null)},k.prototype._settlePromiseFromHandler=function(t,e,r,n){var o;if(!n._isRejected())if(n._pushContext(),o=e!==s||this._isRejected()?b(t).call(e,r):b(t).apply(this._boundValue(),r),n._popContext(),o===w||o===n||o===p){var i=o===n?a():o.e;n._rejectCallback(i,!1,!0)}else n._resolveCallback(o)},k.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},k.prototype._followee=function(){return this._rejectionHandler0},k.prototype._setFollowee=function(t){this._rejectionHandler0=t},k.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},k.prototype._propagateFrom=function(t,e){0<(1&e)&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),0<(4&e)&&t._isBound()&&this._setBoundTo(t._boundTo)},k.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},k.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},k.prototype._settlePromiseAt=function(t){var e=this._promiseAt(t),r=e instanceof k;if(r&&e._isMigrated())return e._unsetIsMigrated(),l.invoke(this._settlePromiseAt,this,t);var n=this._isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,i=this._settledValue,s=this._receiverAt(t);this._clearCallbackDataAtIndex(t),"function"==typeof n?r?this._settlePromiseFromHandler(n,s,i,e):n.call(s,i,e):s instanceof v?s._isResolved()||(this._isFulfilled()?s._promiseFulfilled(i,e):s._promiseRejected(i,e)):r&&(this._isFulfilled()?e._fulfill(i):e._reject(i,o)),4<=t&&4==(31&t)&&l.invokeLater(this._setLength,this,0)},k.prototype._clearCallbackDataAtIndex=function(t){if(0===t)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var e=5*t-5;this[e+3]=this[e+4]=this[e+0]=this[e+1]=this[e+2]=void 0}},k.prototype._isSettlePromisesQueued=function(){return-1073741824==(-1073741824&this._bitField)},k.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},k.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},k.prototype._queueSettlePromises=function(){l.settlePromises(this),this._setSettlePromisesQueued()},k.prototype._fulfillUnchecked=function(t){if(t===this){var e=a();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._setFulfilled(),this._settledValue=t,this._cleanValues(),0<this._length()&&this._queueSettlePromises()},k.prototype._rejectUncheckedCheckError=function(t){var e=i.ensureErrorObject(t);this._rejectUnchecked(t,e===t?void 0:e)},k.prototype._rejectUnchecked=function(t,e){if(t===this){var r=a();return this._attachExtraTrace(r),this._rejectUnchecked(r)}this._setRejected(),this._settledValue=t,this._cleanValues(),this._isFinal()?l.throwLater(function(t){throw"stack"in t&&l.invokeFirst(n.unhandledRejection,void 0,t),t},void 0===e?t:e):(void 0!==e&&e!==t&&this._setCarriedStackTrace(e),0<this._length()?this._queueSettlePromises():this._ensurePossibleRejectionHandled())},k.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var t=this._length(),e=0;e<t;e++)this._settlePromiseAt(e)},i.notEnumerableProp(k,"_makeSelfResolutionError",a),be(k,v),ke(k,f,d,e),Ee(k,f,d),Ce(k,p,d),Ae(k),Fe(k),Se(k,v,d,f),k.version="2.11.0",Oe(k.Promise=k,v,e,d,f),xe(k),Pe(k,e,d,y),Te(k,e,f,d),Re(k),Ne(k),Ue(k,v,d,e),Me(k,f,d,e),ze(k,v,e,d,f),Le(k,v),qe(k,v,e),He(k,f),Ve(k),We(k,f),Ke(k,f),$e(k,f),i.toFastProperties(k),i.toFastProperties(k.prototype),E({a:1}),E({b:2}),E({c:3}),E(1),E(function(){}),E(void 0),E(!1),E(new k(f)),n.setBounds(l.firstLineError,i.lastLineError),k}}),Je;function Ge(){try{Promise===Ye&&(Promise=Je)}catch(t){}return Ye}"undefined"!=typeof Promise&&(Je=Promise);var Ye=Qe();Ye.noConflict=Ge;var Xe=Ye,Ze="object"==typeof N&&N&&N.Object===Object&&N,tr="object"==typeof self&&self&&self.Object===Object&&self,er=Ze||tr||Function("return this")(),rr=er.isFinite;function nr(t){return"number"==typeof t&&rr(t)}var or=nr,ir={blue:{50:"#E4F0F6",100:"#BCD9EA",200:"#8BBDD9",300:"#5BA4CF",400:"#298FCA",500:"#0079BF",600:"#026AA7",700:"#055A8C",800:"#094C72",900:"#0C3953"},green:{50:"#EEF6EC",100:"#D6ECD2",200:"#B7DDB0",300:"#99D18F",400:"#7BC86C",500:"#61BD4F",600:"#5AAC44",700:"#519839",800:"#49852E",900:"#3F6F21"},orange:{50:"#FDF5EC",100:"#FCE8D2",200:"#FAD8B0",300:"#FDC788",400:"#FFB968",500:"#FFAB4A",600:"#E99E40",700:"#D29034",800:"#BB8129",900:"#A0711C"},red:{50:"#FBEDEB",100:"#F5D3CE",200:"#EFB3AB",300:"#EC9488",400:"#EF7564",500:"#EB5A46",600:"#CF513D",700:"#B04632",800:"#933B27",900:"#6E2F1A"},yellow:{50:"#FDFAE5",100:"#FAF3C0",200:"#F5EA92",300:"#F3E260",400:"#F5DD29",500:"#F2D600",600:"#E6C60D",700:"#D9B51C",800:"#CCA42B",900:"#BD903C"},purple:{50:"#F7F0FA",100:"#EDDBF4",200:"#DFC0EB",300:"#D5A6E6",400:"#CD8DE5",500:"#C377E0",600:"#A86CC1",700:"#89609E",800:"#6C547B",900:"#484553"},pink:{50:"#FEF2F9",100:"#FCDEF0",200:"#FAC6E5",300:"#FFB0E1",400:"#FF95D6",500:"#FF80CE",600:"#E76EB1",700:"#CD5A91",800:"#B44772",900:"#96304C"},sky:{50:"#E4F7FA",100:"#BDECF3",200:"#8FDFEB",300:"#5DD3E5",400:"#29CCE5",500:"#00C2E0",600:"#00AECC",700:"#0098B7",800:"#0082A0",900:"#006988"},lime:{50:"#ECFBF3",100:"#D3F6E4",200:"#B3F1D0",300:"#90ECC1",400:"#6DECA9",500:"#51E898",600:"#4FD683",700:"#4DC26B",800:"#4CAF54",900:"#4A9839"},gray:{50:"#F8F9F9",100:"#EDEFF0",200:"#E2E4E6",300:"#D6DADC",400:"#CDD2D4",500:"#C4C9CC",600:"#B6BBBF",700:"#A5ACB0",800:"#959DA1",900:"#838C91"},"business-blue":{50:"#EDEFF4",100:"#D2D7E5",200:"#B2B9D0",300:"#838FB5",400:"#6170A1",500:"#42548E",600:"#3E4D80",700:"#3A476F",800:"#36405F",900:"#30364C"},shades:{0:"#FFFFFF",10:"#FAFCFC",20:"#F5F6F7",30:"#EBEEF0",40:"#DFE3E6",50:"#C2CCD1",60:"#B3BEC4",70:"#A6B3BA",80:"#97A7B0",90:"#899AA3",100:"#798D99",200:"#6B808C",300:"#5E7785",400:"#516B7A",500:"#425E6E",600:"#355263",700:"#254659",800:"#17394D",900:"#092D42"}};ir.neutrals=ir.shades;var sr=function(t,e){if(!t||"string"!=typeof t)throw new Error("Invalid color name");var r=t.toLowerCase();if(!ir[r])throw new Error("Unknown color name: ".concat(r));var n=or(e)?e:500;if(!ir[r][n])throw new Error("Unknown color weight: ".concat(n));return ir[r][n]},ar=function(t){if(!t||"string"!=typeof t)throw new Error("Invalid named color string");if(/^#[a-fA-F0-9]{6}$/.test(t))return t;var e=/^([a-zA-Z-]+)(#[1-9]?0?0)?$/.exec(t);if(!e)throw new Error("Invalid accentColor provided");var r=e[1],n=500;return e[2]&&(n=parseInt(e[2].substring(1),10)),sr(r,n)};function cr(t){if(!t)return null;for(var e=0;e<t.length;e+=1){var r=t[e];if("number"!=typeof r||r%1!=0||255<r||r<0)throw new Error("Invalid bytes. Bytes must be 0 - 255")}for(var n=new Uint8Array(t),o=[],i=0;i<n.length;i+=1){var s=n[i].toString(16);s.length<2&&(s="0".concat(s)),o.push(s)}return o.join("")}function ur(t){if(!t)throw new Error("Invalid hexString");var e=t.toLowerCase();if(!/^[0-9a-f]+$/.test(e)||e.length%2!=0)throw new Error("Invalid hexString");for(var r=new Uint8Array(e.length/2),n=0;n<e.length;n+=2){var o=parseInt(e.substr(n,2),16);if(isNaN(o))throw new Error("Invalid hexString");r[n/2]=o}return r}function lr(t,e,r){return e<=t&&t<=r}function hr(t){if(void 0===t)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function fr(t){for(var e=String(t),r=e.length,n=0,o=[];n<r;){var i=e.charCodeAt(n);if(i<55296||57343<i)o.push(i);else if(56320<=i&&i<=57343)o.push(65533);else if(55296<=i&&i<=56319)if(n===r-1)o.push(65533);else{var s=t.charCodeAt(n+1);if(56320<=s&&s<=57343){var a=1023&i,c=1023&s;o.push(65536+(a<<10)+c),n+=1}else o.push(65533)}n+=1}return o}function pr(t){for(var e="",r=0;r<t.length;++r){var n=t[r];n<=65535?e+=String.fromCharCode(n):(n-=65536,e+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return e}var dr=-1;function vr(t){this.tokens=[].slice.call(t)}vr.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():dr},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.pop());else this.tokens.unshift(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.shift());else this.tokens.push(t)}};var yr=-1;function _r(t,e){if(t)throw TypeError("Decoder error");return e||65533}var gr="utf-8";function mr(t,e){if(!(this instanceof mr))return new mr(t,e);if((t=void 0!==t?String(t).toLowerCase():gr)!==gr)throw new Error("Encoding not supported. Only utf-8 is supported");e=hr(e),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(e.fatal),this._ignoreBOM=Boolean(e.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function wr(t,e){if(!(this instanceof wr))return new wr(t,e);if((t=void 0!==t?String(t).toLowerCase():gr)!==gr)throw new Error("Encoding not supported. Only utf-8 is supported");e=hr(e),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(e.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function br(t){var n=t.fatal,o=0,i=0,s=0,a=128,c=191;this.handler=function(t,e){if(e===dr&&0!==s)return s=0,_r(n);if(e===dr)return yr;if(0===s){if(lr(e,0,127))return e;if(lr(e,194,223))s=1,o=e-192;else if(lr(e,224,239))224===e&&(a=160),237===e&&(c=159),s=2,o=e-224;else{if(!lr(e,240,244))return _r(n);240===e&&(a=144),244===e&&(c=143),s=3,o=e-240}return o<<=6*s,null}if(!lr(e,a,c))return o=s=i=0,a=128,c=191,t.prepend(e),_r(n);if(c=191,o+=e-(a=128)<<6*(s-(i+=1)),i!==s)return null;var r=o;return o=s=i=0,r}}function kr(t){t.fatal;this.handler=function(t,e){if(e===dr)return yr;if(lr(e,0,127))return e;var r,n;lr(e,128,2047)?(r=1,n=192):lr(e,2048,65535)?(r=2,n=224):lr(e,65536,1114111)&&(r=3,n=240);for(var o=[(e>>6*r)+n];0<r;){var i=e>>6*(r-1);o.push(128|63&i),r-=1}return o}}mr.prototype={decode:function(t,e){var r;r="object"==typeof t&&t instanceof ArrayBuffer?new Uint8Array(t):"object"==typeof t&&"buffer"in t&&t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e=hr(e),this._streaming||(this._decoder=new br({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(e.stream);for(var n,o=new vr(r),i=[];!o.endOfStream()&&(n=this._decoder.handler(o,o.read()))!==yr;)null!==n&&(Array.isArray(n)?i.push.apply(i,n):i.push(n));if(!this._streaming){do{if((n=this._decoder.handler(o,o.read()))===yr)break;null!==n&&(Array.isArray(n)?i.push.apply(i,n):i.push(n))}while(!o.endOfStream());this._decoder=null}return i.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===i[0]?(this._BOMseen=!0,i.shift()):this._BOMseen=!0)),pr(i)}},wr.prototype={encode:function(t,e){t=t?String(t):"",e=hr(e),this._streaming||(this._encoder=new kr(this._options)),this._streaming=Boolean(e.stream);for(var r,n=[],o=new vr(fr(t));!o.endOfStream()&&(r=this._encoder.handler(o,o.read()))!==yr;)Array.isArray(r)?n.push.apply(n,r):n.push(r);if(!this._streaming){for(;(r=this._encoder.handler(o,o.read()))!==yr;)Array.isArray(r)?n.push.apply(n,r):n.push(r);this._encoder=null}return new Uint8Array(n)}};var Er=function(t){return"function"==typeof t},Cr=Er(window.TextEncoder)?window.TextEncoder:wr,jr=Er(window.TextDecoder)?window.TextDecoder:mr,Ar="AES-CBC",Fr={name:Ar,length:256},Sr=!0,Or=["encrypt","decrypt"],xr="object"===s(window.crypto),Pr=!xr&&"object"===s(window.msCrypto),Tr;xr?Tr=null==window.crypto.subtle&&null!=window.crypto.webkitSubtle?window.crypto.webkitSubtle:window.crypto.subtle:Pr&&(Tr=window.msCrypto.subtle);var Rr=function(t){var n=(new Cr).encode(t);return new Xe(function(e,r){if(xr)Tr.digest({name:"SHA-256"},n).then(function(t){return e(cr(t))});else if(Pr){var t=Tr.digest({name:"SHA-256"},n);t.oncomplete=function(t){e(cr(t.target.result))},t.onerror=function(t){r(new Error("Error digesting text: ".concat(t.type)))}}else r(new Error("Browser not supported."))})},Dr={generateInitVector:function(){if(xr&&"function"==typeof window.crypto.getRandomValues)return window.crypto.getRandomValues(new Uint8Array(16));if(Pr&&"function"==typeof window.msCrypto.getRandomValues)return window.msCrypto.getRandomValues(new Uint8Array(16));throw new Error("Browser not supported.")},generateAESCBCKey:function(){return new Xe(function(e,r){if(xr)e(Tr.generateKey(Fr,Sr,Or));else if(Pr){var t=Tr.generateKey(Fr,Sr,Or);t.oncomplete=function(t){e(t.target.result)},t.onerror=function(t){r(new Error("Error generating key: ".concat(t.type)))}}else r(new Error("Browser not supported."))})},importAESCBCKeyFromRaw:function(t){var n=ur(t);return new Xe(function(e,r){if(xr)e(Tr.importKey("raw",n,Ar,Sr,Or));else if(Pr){var t=Tr.importKey("raw",n,Ar,Sr,Or);t.oncomplete=function(t){e(t.target.result)},t.onerror=function(t){r(new Error("Error importing key: ".concat(t.type)))}}else r(new Error("Browser not supported."))})},exportAESCBCKeyToRaw:function(n){return new Xe(function(e,r){if(xr)Tr.exportKey("raw",n).then(function(t){return e(cr(t))});else if(Pr){var t=Tr.exportKey("raw",n);t.oncomplete=function(t){e(cr(t.target.result))},t.onerror=function(t){r(new Error("Error exporting key: ".concat(t.type)))}}else r(new Error("Browser not supported."))})},encryptSecret:function(o,i,e){return Rr(e).then(function(t){var n=(new Cr).encode(t+e);return xr?Tr.encrypt({name:Ar,iv:o},i,n).then(function(t){return cr(t)}):Pr?new Xe(function(e,r){var t=Tr.encrypt({name:Ar,iv:o},i,n);t.oncomplete=function(t){e(cr(t.target.result))},t.onerror=function(t){r(new Error("Error encrypting secret: ".concat(t.type)))}}):Xe.reject(new Error("Browser not supported."))})},decryptSecret:function(n,o,t){var i=ur(t);return new Xe(function(e,r){if(xr)Tr.decrypt({name:Ar,iv:n},o,i).then(function(t){e((new jr).decode(t))}).catch(function(t){r(new Error("Decryption failed. Message: ".concat(t.message)))});else if(Pr){var t=Tr.decrypt({name:Ar,iv:n},o,i);t.oncomplete=function(t){e((new jr).decode(t.target.result))},t.onerror=function(t){r(new Error("Decryption failed. Message: ".concat(t.type)))}}else r(new Error("Browser not supported."))}).then(function(t){var e=t.substring(0,64),r=t.substring(64);if(!/^[a-f0-9]{64}$/.test(e))throw new Error("Decryption failed. Unable to validate integrity.");return Rr(r).then(function(t){if(t===e)return r;throw new Error("Decryption failed. Unable to validate integrity.")})})},sha256Digest:Rr},Ir=U(function(t,e){var o="undefined"!=typeof Reflect?Reflect.construct:void 0,n=Object.defineProperty,r=Error.captureStackTrace;function i(t){void 0!==t&&n(this,"message",{configurable:!0,value:t,writable:!0});var e=this.constructor.name;void 0!==e&&e!==this.name&&n(this,"name",{configurable:!0,value:e,writable:!0}),r(this,this.constructor)}void 0===r&&(r=function(e){var r=new Error;n(e,"stack",{configurable:!0,get:function(){var t=r.stack;return n(this,"stack",{configurable:!0,value:t,writable:!0}),t},set:function(t){n(e,"stack",{configurable:!0,value:t,writable:!0})}})}),i.prototype=Object.create(Error.prototype,{constructor:{configurable:!0,value:i,writable:!0}});var s=function(){function t(t,e){return n(t,"name",{configurable:!0,value:e})}try{var e=function(){};if(t(e,"foo"),"foo"===e.name)return t}catch(t){}}();(t.exports=function(t,e){if(null==e||e===Error)e=i;else if("function"!=typeof e)throw new TypeError("super_ should be a function");var r;if("string"==typeof t)r=t,t=void 0!==o?function(){return o(e,arguments,this.constructor)}:function(){e.apply(this,arguments)},void 0!==s&&(s(t,r),r=void 0);else if("function"!=typeof t)throw new TypeError("constructor should be either a string or a function");t.super_=t.super=e;var n={constructor:{configurable:!0,value:t,writable:!0}};return void 0!==r&&(n.name={configurable:!0,value:r,writable:!0}),t.prototype=Object.create(e.prototype,n),t}).BaseError=i}),Br=Ir.BaseError,Nr="Error",Ur=function(e,t){var r=Ir([e,Nr].join("::"));return t.forEach(function(t){r[t]=Ir([e,t].join("::"),r)}),r},Mr=Ur("i18n",["ArgNotFound","InvalidResourceUrl","KeyNotFound","LoadLocalizerNotAFunction","LocaleNotFound","LocaleNotSpecified","LocalizerNotFound","MissingDefaultLocale","MissingResourceUrl","MissingSupportedLocales","UnableToParseArgs","UnableToParseAttrs","Unknown","UnsupportedKeyType"]),zr=function(t,e){if(t.indexOf("{locale}")<0)throw new Mr.InvalidResourceUrl("ResourceUrl must specify where to place locale with {locale}");return t.replace("{locale}",e)},Lr=function t(e,r,n){return-1<n.indexOf(e)?e:-1<e.indexOf("-")?t(e.split("-")[0],r,n):r},qr=function(){function e(t){h(this,e),this.resourceDictionary=t}return r(e,[{key:"localize",value:function(t,e){if(this.resourceDictionary[t]){var r=this.resourceDictionary[t];if(e){for(var n=/\{(\w+?)\}/gi,o="",i=n.exec(r),s=0;i;){if(i.index>s&&(o+=r.substring(s,i.index)),!e[i[1]])throw new Mr.ArgNotFound("Arg: ".concat(i[1]));o+=e[i[1]],s=i.index+i[0].length,i=n.exec(r)}return o+=r.substring(s)}return r}throw new Mr.KeyNotFound("Key: ".concat(t))}}]),e}(),Hr,Vr,Wr="",Kr=function(t,e,r,i){return Xe.try(function(){var o;return(o=t?Lr(t,e,r):e)===Wr&&Vr?Vr:(Hr||(Hr=new Xe(function(e,r){var n=new XMLHttpRequest;n.open("GET",zr(i,o),!0),n.onload=function(){try{if(200!==n.status)return 404===n.status?r(new Mr.LocaleNotFound("".concat(o," not found."))):r(new Mr.Unknown("Unable to load locale, status: ".concat(n.status)));var t=JSON.parse(n.responseText);return Vr=new qr(t),Wr=o,e(Vr)}catch(t){return r(new Mr.Unknown(t.message))}},n.send()})),Hr)})},$r={loadLocalizer:Kr},Qr=function(t,e){var r=e||{},n="";if(!t)return n="Unable to load a localizer without a locale",Xe.reject(new Mr.LocaleNotSpecified(n));if(window.localizer)return Xe.resolve();if(r.localizer)window.localizer=r.localizer;else{if(r.loadLocalizer)return"function"==typeof r.loadLocalizer?Xe.resolve(r.loadLocalizer(t)).then(function(t){return window.localizer=t,Xe.resolve()}):(n="Specified loadLocalizer must be a function that returns a localizer or a Promise resolving to a localizer",Xe.reject(new Mr.LoadLocalizerNotAFunction(n)));if(r.localization){var o=r.localization,i=o.defaultLocale,s=o.supportedLocales,a=o.resourceUrl;return i?s?a?$r.loadLocalizer(t,i,s,a).then(function(t){return window.localizer=t,Xe.resolve()}):Xe.reject(new Mr.MissingResourceUrl("Missing resourceUrl")):Xe.reject(new Mr.MissingSupportedLocales("Missing supportedLocales")):Xe.reject(new Mr.MissingDefaultLocale("Missing defaultLocale"))}}return Xe.resolve()},Jr=function(t){if(/^https?:\/\//.test(t))return t;var e=window.location.origin||"".concat(window.location.protocol,"//").concat(window.location.host),r=window.location.pathname.replace(/[^/]+$/,"");return/^\/\//.test(t)?[e,t.substring(1)].join(""):/^\//.test(t)?[e,t].join(""):[e,r,t].join("")},Gr="Expected a function",Yr="__lodash_hash_undefined__",Xr=1/0,Zr=9007199254740991,tn="[object Arguments]",en="[object Function]",rn="[object GeneratorFunction]",nn="[object Symbol]",on=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,sn=/^\w*$/,an=/^\./,cn=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,un=/[\\^$.*+?()[\]{}|]/g,ln=/\\(\\)?/g,hn=/^\[object .+?Constructor\]$/,fn=/^(?:0|[1-9]\d*)$/,pn="object"==typeof N&&N&&N.Object===Object&&N,dn="object"==typeof self&&self&&self.Object===Object&&self,vn=pn||dn||Function("return this")();function yn(t,e){return null==t?void 0:t[e]}function _n(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}var gn=Array.prototype,mn=Function.prototype,wn=Object.prototype,bn=vn["__core-js_shared__"],kn=(En=/[^.]+$/.exec(bn&&bn.keys&&bn.keys.IE_PROTO||""),En?"Symbol(src)_1."+En:""),En,Cn=mn.toString,jn=wn.hasOwnProperty,An=wn.toString,Fn=RegExp("^"+Cn.call(jn).replace(un,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Sn=vn.Symbol,On=wn.propertyIsEnumerable,xn=gn.splice,Pn=io(vn,"Map"),Tn=io(Object,"create"),Rn=Sn?Sn.prototype:void 0,Dn=Rn?Rn.toString:void 0;function In(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Bn(){this.__data__=Tn?Tn(null):{}}function Nn(t){return this.has(t)&&delete this.__data__[t]}function Un(t){var e=this.__data__;if(Tn){var r=e[t];return r===Yr?void 0:r}return jn.call(e,t)?e[t]:void 0}function Mn(t){var e=this.__data__;return Tn?void 0!==e[t]:jn.call(e,t)}function zn(t,e){return this.__data__[t]=Tn&&void 0===e?Yr:e,this}function Ln(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function qn(){this.__data__=[]}function Hn(t){var e=this.__data__,r=Zn(e,t);return!(r<0)&&(r==e.length-1?e.pop():xn.call(e,r,1),!0)}function Vn(t){var e=this.__data__,r=Zn(e,t);return r<0?void 0:e[r][1]}function Wn(t){return-1<Zn(this.__data__,t)}function Kn(t,e){var r=this.__data__,n=Zn(r,t);return n<0?r.push([t,e]):r[n][1]=e,this}function $n(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Qn(){this.__data__={hash:new In,map:new(Pn||Ln),string:new In}}function Jn(t){return oo(this,t).delete(t)}function Gn(t){return oo(this,t).get(t)}function Yn(t){return oo(this,t).has(t)}function Xn(t,e){return oo(this,t).set(t,e),this}function Zn(t,e){for(var r=t.length;r--;)if(yo(t[r][0],e))return r;return-1}function to(t,e){return null!=t&&jn.call(t,e)}function eo(t){return!(!Eo(t)||lo(t))&&(bo(t)||_n(t)?Fn:hn).test(po(t))}function ro(t){if("string"==typeof t)return t;if(jo(t))return Dn?Dn.call(t):"";var e=t+"";return"0"==e&&1/t==-Xr?"-0":e}function no(t){return go(t)?t:ho(t)}function oo(t,e){var r=t.__data__;return uo(e)?r["string"==typeof e?"string":"hash"]:r.map}function io(t,e){var r=yn(t,e);return eo(r)?r:void 0}function so(t,e,r){for(var n,o=-1,i=(e=co(e,t)?[e]:no(e)).length;++o<i;){var s=fo(e[o]);if(!(n=null!=t&&r(t,s)))break;t=t[s]}return n||!!(i=t?t.length:0)&&ko(i)&&ao(s,i)&&(go(t)||_o(t))}function ao(t,e){return!!(e=null==e?Zr:e)&&("number"==typeof t||fn.test(t))&&-1<t&&t%1==0&&t<e}function co(t,e){if(go(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!jo(t))||(sn.test(t)||!on.test(t)||null!=e&&t in Object(e))}function uo(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function lo(t){return!!kn&&kn in t}In.prototype.clear=Bn,In.prototype.delete=Nn,In.prototype.get=Un,In.prototype.has=Mn,In.prototype.set=zn,Ln.prototype.clear=qn,Ln.prototype.delete=Hn,Ln.prototype.get=Vn,Ln.prototype.has=Wn,Ln.prototype.set=Kn,$n.prototype.clear=Qn,$n.prototype.delete=Jn,$n.prototype.get=Gn,$n.prototype.has=Yn,$n.prototype.set=Xn;var ho=vo(function(t){t=Ao(t);var o=[];return an.test(t)&&o.push(""),t.replace(cn,function(t,e,r,n){o.push(r?n.replace(ln,"$1"):e||t)}),o});function fo(t){if("string"==typeof t||jo(t))return t;var e=t+"";return"0"==e&&1/t==-Xr?"-0":e}function po(t){if(null!=t){try{return Cn.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function vo(o,i){if("function"!=typeof o||i&&"function"!=typeof i)throw new TypeError(Gr);var s=function(){var t=arguments,e=i?i.apply(this,t):t[0],r=s.cache;if(r.has(e))return r.get(e);var n=o.apply(this,t);return s.cache=r.set(e,n),n};return s.cache=new(vo.Cache||$n),s}function yo(t,e){return t===e||t!=t&&e!=e}function _o(t){return wo(t)&&jn.call(t,"callee")&&(!On.call(t,"callee")||An.call(t)==tn)}vo.Cache=$n;var go=Array.isArray;function mo(t){return null!=t&&ko(t.length)&&!bo(t)}function wo(t){return Co(t)&&mo(t)}function bo(t){var e=Eo(t)?An.call(t):"";return e==en||e==rn}function ko(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Zr}function Eo(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Co(t){return!!t&&"object"==typeof t}function jo(t){return"symbol"==typeof t||Co(t)&&An.call(t)==nn}function Ao(t){return null==t?"":ro(t)}function Fo(t,e){return null!=t&&so(t,e,to)}var So=Fo,Oo=function(t){window.console&&"function"==typeof console.warn&&console.warn(t)},xo={},Po={},To=0;setInterval(function(){var t=Object.keys(xo),e=Date.now();t.forEach(function(t){xo[t].expires<e&&delete xo[t]})},5e3);var Ro={callback:function(t,e,r){var n=e.callback,o=e.action,i=e.options;return Xe.try(function(){switch(o){case"run":if(So(Po,n))return Po[n].call(null,t,i);throw Oo("Attempted to run callback that does not exist or was not retained"),t.NotHandled("callback does not exist or was not retained");case"retain":if(So(xo,n))return Po[n]=xo[n].fx,delete xo[n],n;throw Oo("Attempted to retain callback that does not exist"),t.NotHandled("callback can no longer be retained");case"release":if(So(Po,n))return delete Po[n],null;throw Oo("Attempted to release callback that is not retained"),t.NotHandled("callback can no longer be released");default:throw Oo("Attempted an unknown callback action"),t.NotHandled("unknown callback action")}}).then(r)},serialize:function(t){var e="cb".concat(To+=1);return xo[e]={fx:t,expires:Date.now()+3e4},{_callback:e}},reset:function(){To=0,Object.keys(xo).forEach(function(t){delete xo[t]}),Object.keys(Po).forEach(function(t){delete Po[t]})}},Do=null,Io=function(t,e){if(!Do)try{Do=JSON.parse(decodeURIComponent(window.location.hash.replace(/^#/,"")))}catch(t){Do={}}return So(Do,t)?Do[t]:e},Bo=1/0,No=9007199254740991,Uo=17976931348623157e292,Mo=NaN,zo="[object Arguments]",Lo="[object Function]",qo="[object GeneratorFunction]",Ho="[object String]",Vo="[object Symbol]",Wo=/^\s+|\s+$/g,Ko=/^[-+]0x[0-9a-f]+$/i,$o=/^0b[01]+$/i,Qo=/^0o[0-7]+$/i,Jo=/^(?:0|[1-9]\d*)$/,Go=parseInt;function Yo(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}function Xo(t,e,r,n){for(var o=t.length,i=r+(n?1:-1);n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}function Zo(t,e,r){if(e!=e)return Xo(t,ti,r);for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}function ti(t){return t!=t}function ei(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}function ri(e,t){return Yo(t,function(t){return e[t]})}function ni(e,r){return function(t){return e(r(t))}}var oi=Object.prototype,ii=oi.hasOwnProperty,si=oi.toString,ai=oi.propertyIsEnumerable,ci=ni(Object.keys,Object),ui=Math.max;function li(t,e){var r=yi(t)||vi(t)?ei(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!ii.call(t,i)||o&&("length"==i||fi(i,n))||r.push(i);return r}function hi(t){if(!pi(t))return ci(t);var e=[];for(var r in Object(t))ii.call(t,r)&&"constructor"!=r&&e.push(r);return e}function fi(t,e){return!!(e=null==e?No:e)&&("number"==typeof t||Jo.test(t))&&-1<t&&t%1==0&&t<e}function pi(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||oi)}function di(t,e,r,n){t=_i(t)?t:Oi(t),r=r&&!n?Ai(r):0;var o=t.length;return r<0&&(r=ui(o+r,0)),Ei(t)?r<=o&&-1<t.indexOf(e,r):!!o&&-1<Zo(t,e,r)}function vi(t){return gi(t)&&ii.call(t,"callee")&&(!ai.call(t,"callee")||si.call(t)==zo)}var yi=Array.isArray;function _i(t){return null!=t&&wi(t.length)&&!mi(t)}function gi(t){return ki(t)&&_i(t)}function mi(t){var e=bi(t)?si.call(t):"";return e==Lo||e==qo}function wi(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=No}function bi(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ki(t){return!!t&&"object"==typeof t}function Ei(t){return"string"==typeof t||!yi(t)&&ki(t)&&si.call(t)==Ho}function Ci(t){return"symbol"==typeof t||ki(t)&&si.call(t)==Vo}function ji(t){return t?(t=Fi(t))!==Bo&&t!==-Bo?t==t?t:0:(t<0?-1:1)*Uo:0===t?t:0}function Ai(t){var e=ji(t),r=e%1;return e==e?r?e-r:e:0}function Fi(t){if("number"==typeof t)return t;if(Ci(t))return Mo;if(bi(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=bi(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(Wo,"");var r=$o.test(t);return r||Qo.test(t)?Go(t.slice(2),r?2:8):Ko.test(t)?Mo:+t}function Si(t){return _i(t)?li(t):hi(t)}function Oi(t){return t?ri(t,Si(t)):[]}var xi=di,Pi="[object Object]";function Ti(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function Ri(e,r){return function(t){return e(r(t))}}var Di=Function.prototype,Ii=Object.prototype,Bi=Di.toString,Ni=Ii.hasOwnProperty,Ui=Bi.call(Object),Mi=Ii.toString,zi=Ri(Object.getPrototypeOf,Object);function Li(t){return!!t&&1===t.nodeType&&qi(t)&&!Hi(t)}function qi(t){return!!t&&"object"==typeof t}function Hi(t){if(!qi(t)||Mi.call(t)!=Pi||Ti(t))return!1;var e=zi(t);if(null===e)return!0;var r=Ni.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&Bi.call(r)==Ui}var Vi=Li,Wi="[object String]",Ki=Object.prototype,$i=Ki.toString,Qi=Array.isArray;function Ji(t){return!!t&&"object"==typeof t}function Gi(t){return"string"==typeof t||!Qi(t)&&Ji(t)&&$i.call(t)==Wi}var Yi=Gi,Xi=1/0,Zi=9007199254740991,ts="[object Arguments]",es="[object Function]",rs="[object GeneratorFunction]",ns="[object Symbol]",os="object"==typeof N&&N&&N.Object===Object&&N,is="object"==typeof self&&self&&self.Object===Object&&self,ss=os||is||Function("return this")();function as(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function cs(t,e){for(var r=-1,n=t?t.length:0,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}function us(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}var ls=Object.prototype,hs=ls.hasOwnProperty,fs=ls.toString,ps=ss.Symbol,ds=ls.propertyIsEnumerable,vs=ps?ps.isConcatSpreadable:void 0,ys=Math.max;function _s(t,e,r,n,o){var i=-1,s=t.length;for(r||(r=bs),o||(o=[]);++i<s;){var a=t[i];0<e&&r(a)?1<e?_s(a,e-1,r,n,o):us(o,a):n||(o[o.length]=a)}return o}function gs(r,t){return ms(r=Object(r),t,function(t,e){return e in r})}function ms(t,e,r){for(var n=-1,o=e.length,i={};++n<o;){var s=e[n],a=t[s];r(a,s)&&(i[s]=a)}return i}function ws(i,s){return s=ys(void 0===s?i.length-1:s,0),function(){for(var t=arguments,e=-1,r=ys(t.length-s,0),n=Array(r);++e<r;)n[e]=t[s+e];e=-1;for(var o=Array(s+1);++e<s;)o[e]=t[e];return o[s]=n,as(i,this,o)}}function bs(t){return Cs(t)||Es(t)||!!(vs&&t&&t[vs])}function ks(t){if("string"==typeof t||Ps(t))return t;var e=t+"";return"0"==e&&1/t==-Xi?"-0":e}function Es(t){return As(t)&&hs.call(t,"callee")&&(!ds.call(t,"callee")||fs.call(t)==ts)}var Cs=Array.isArray;function js(t){return null!=t&&Ss(t.length)&&!Fs(t)}function As(t){return xs(t)&&js(t)}function Fs(t){var e=Os(t)?fs.call(t):"";return e==es||e==rs}function Ss(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Zi}function Os(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function xs(t){return!!t&&"object"==typeof t}function Ps(t){return"symbol"==typeof t||xs(t)&&fs.call(t)==ns}var Ts=ws(function(t,e){return null==t?{}:gs(t,cs(_s(e,1),ks))}),Rs=Ts,Ds=function e(r,t){if(!r)return r;if(("url"===t||"icon"===t)&&"string"==typeof r&&0===r.indexOf("./"))return Jr(r.substr(2));var n={};switch(s(r)){case"object":return Array.isArray(r)?r.map(e):(Object.keys(r).forEach(function(t){n[t]=e(r[t],t)}),n);case"function":return Ro.serialize(r);default:return r}},Is=function(t){return String(null==t?"":t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#x60;")},Bs={isId:function(t){return/^[a-f0-9]{24}$/.test(t)},isShortLink:function(t){return/^[a-zA-Z0-9]{8}$/.test(t)},isAllowedVisibilty:function(t){return-1!==["shared","private"].indexOf(t)},isAllowedScope:function(t){return-1!==["board","card","member","organization"].indexOf(t)}},Ns=4096,Us={getContext:function(){return this.args[0].context},isMemberSignedIn:function(){var t=this.getContext();return null!=t&&"notLoggedIn"!==t.member&&null!=t.member},memberCanWriteToModel:function(t){if(!this.isMemberSignedIn())return!1;if("string"!=typeof t||!xi(["board","card","organization"],t))throw new Error("modelType must be one of: board, card, organization");var e=this.getContext();return null!=e&&null!=e.permissions&&"write"===e.permissions[t]},requestWithContext:function(t,e){var r=e||{};return r.context="function"==typeof this.getContext?this.getContext():{},this.request(t,Ds(r))},getAll:function(){var e=this;return e.outstandingGetAllReq||(e.outstandingGetAllReq=e.requestWithContext("data").then(function(t){var n={};return Object.keys(t).forEach(function(r){n[r]={},Object.keys(t[r]).forEach(function(e){try{n[r][e]=JSON.parse(t[r][e])}catch(t){n[r][e]={}}})}),e.outstandingGetAllReq=null,n}).catch(function(t){throw e.outstandingGetAllReq=null,t})),e.outstandingGetAllReq},get:function(r,n,o,i){var s=this;s.outstandingGetRequests||(s.outstandingGetRequests=new Map);var a="GET",t={};if((Bs.isId(r)||Bs.isShortLink(r))&&(t.idCard=r,r="card",a="GET:".concat(t.idCard)),!Bs.isAllowedVisibilty(n))throw new Error("Invalid value for visibility.");if(!Bs.isAllowedScope(r))throw new Error("Invalid value for scope.");return s.outstandingGetRequests.has(a)||s.outstandingGetRequests.set(a,s.requestWithContext("data",t)),s.outstandingGetRequests.get(a).then(function(t){var e={};if(t&&So(t,r)&&So(t[r],n))try{e=JSON.parse(t[r][n])}catch(t){}return s.outstandingGetRequests.delete(a),null==o?e||i:null!=e&&So(e,o)?e[o]:i}).catch(function(t){throw s.outstandingGetRequests.delete(a),t})},set:function(t,e,r,n){var o={scope:t,visibility:e},i=this;if(!Bs.isAllowedVisibilty(e))throw new Error("Invalid value for visibility.");if((Bs.isId(t)||Bs.isShortLink(t))&&(o.idCard=t,o.scope="card"),!Bs.isAllowedScope(o.scope))throw new Error("Invalid value for scope.");return this.get(t,e).then(function(t){var e=t||{};if("object"===s(r)?Object.keys(r).forEach(function(t){e[t]=r[t]}):e[r]=n,o.data=JSON.stringify(e),o.data.length>Ns)throw new Error("PluginData length of ".concat(Ns," characters exceeded. See: https://developers.trello.com/v1.0/reference#section-size-limit"));return i.requestWithContext("set",o)})},remove:function(t,e,r){var n={scope:t,visibility:e},o=r,i=this;if((Bs.isId(t)||Bs.isShortLink(t))&&(n.idCard=t,n.scope="card"),Array.isArray(o)||(o=[r]),o.some(function(t){return"string"!=typeof t}))return Oo("t.remove function takes either a single string or an array of strings for which keys to remove"),null;if(!Bs.isAllowedScope(n.scope))throw new Error("Invalid value for scope.");if(!Bs.isAllowedVisibilty(e))throw new Error("Invalid value for visibility.");return this.get(t,e).then(function(t){var e=t||{};return o.forEach(function(t){delete e[t]}),n.data=JSON.stringify(e),i.requestWithContext("set",n)})}};Us.safe=Is,Us.arg=function(t,e){var r=this.args[1];return r&&"object"===s(r)&&So(r,t)?r[t]:e},Us.signUrl=function(t,e){var r=this.getContext();return[t,encodeURIComponent(JSON.stringify({secret:this.secret,context:r,locale:window.locale,args:e}))].join("#")},Us.navigate=function(t){return t&&"object"===s(t)&&"string"==typeof t.url?this.requestWithContext("navigate",t):Xe.reject(new Error("Invalid or missing url provided in options object"))},Us.showCard=function(t){return t&&"string"==typeof t?this.requestWithContext("showCard",{idCard:t}):Xe.reject(new Error("Invalid idCard provided"))},Us.hideCard=function(){return this.requestWithContext("hideCard")},Us.alert=function(t){var e=Rs(t,["message","duration","display"]),r=e.message;return!Yi(r)||r.length<1||140<r.length?Xe.reject(new Error("Alert requires a message of 1 to 140 characters")):this.requestWithContext("alert",e)},Us.hideAlert=function(){return this.requestWithContext("hideAlert")},Us.popup=function(r){if(!this.getContext().el)return Oo("Unable to open popup. Context missing target element. This usually means you are using the wrong t param, and should instead use the one provided to the callback function itself, not the capability handler."),Xe.reject(new Error("Context missing target element"));var t={title:r.title};if(r&&"function"==typeof r.callback&&(t.callback=r.callback),r.url)t.content={type:"iframe",url:this.signUrl(Jr(r.url),r.args),width:r.width,height:r.height};else if(r.items){var e;e=Array.isArray(r.items)||"function"==typeof r.items?r.items:Object.keys(r.items).map(function(t){var e=r.items[t];return"function"==typeof e?{text:t,callback:e}:e&&"function"==typeof e.callback?m({text:t},e):{text:t}}),t.content={items:e,type:"list",search:r.search}}return this.requestWithContext("popup",t)},Us.overlay=function(t){Oo("overlay() has been deprecated. Please use modal() instead. See: https://trello.readme.io/v1.0/reference#t-modal");var e={};return t.url&&(e.content={type:"iframe",url:this.signUrl(Jr(t.url),t.args)}),this.requestWithContext("overlay",e)},Us.boardBar=function(t){if(!t||!t.url||"string"!=typeof t.url)throw new Error("BoardBar options requires a valid url");if(t.actions&&!Array.isArray(t.actions))throw new Error("BoardBar actions property must be an array");var e;t.accentColor&&(e=ar(t.accentColor));var r={content:{actions:t.actions||[],callback:t.callback,accentColor:e,height:t.height||200,resizable:t.resizable||!1,title:t.title,type:"iframe",url:this.signUrl(Jr(t.url),t.args)}};return this.requestWithContext("board-bar",r)},Us.modal=function(t){if(!t||!t.url||"string"!=typeof t.url)throw new Error("Modal options requires a valid url");if(t.actions&&!Array.isArray(t.actions))throw new Error("Modal actions property must be an array");var e;t.accentColor&&(e=ar(t.accentColor));var r={content:{actions:t.actions||[],callback:t.callback,accentColor:e,fullscreen:t.fullscreen||!1,height:t.height||400,title:t.title,type:"iframe",url:this.signUrl(Jr(t.url),t.args)}};return this.requestWithContext("modal",r)},Us.updateModal=function(t){if(!t)return Xe.resolve();var e=t.accentColor,r=t.actions,n=t.fullscreen,o=t.title;if(!(e||r||n||o))return Xe.resolve();if(t.url)throw new Error("Updating Modal url not allowed");if(t.callback)throw new Error("Unable to update callback. You can set onBeforeUnload to run code before Modal close: https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload");if(r&&!Array.isArray(r))throw new Error("Modal actions property must be an array");var i={content:Rs(t,["actions","accentColor","fullscreen","title"])};return e&&(i.content.accentColor=ar(e)),this.requestWithContext("update-modal",i)},Us.hide=function(){return Oo("hide() handler has been deprecated. Please use closePopup()"),this.requestWithContext("close-popup")},Us.closePopup=function(){return this.requestWithContext("close-popup")},Us.back=function(){return this.requestWithContext("pop-popup")},Us.hideOverlay=function(){return Oo("hideOverlay() handler has been deprecated. Please use closeOverlay()"),this.requestWithContext("close-overlay")},Us.closeOverlay=function(){return Oo("overlay() has been deprecated. Please use modal() instead. See: https://trello.readme.io/v1.0/reference#t-modal"),this.requestWithContext("close-overlay")},Us.hideBoardBar=function(){return Oo("hideBoardBar() handler has been deprecated. Please use closeBoardBar()"),this.requestWithContext("close-board-bar")},Us.closeBoardBar=function(){return this.requestWithContext("close-board-bar")},Us.closeModal=function(){return this.requestWithContext("close-modal")},Us.sizeTo=function(t){var e;if(Yi(t)){var r=document.querySelector(t);if(!r)return Xe.reject(new Error("No elements matched"));r.style.overflow="hidden",e=Math.ceil(Math.max(r.scrollHeight,r.getBoundingClientRect().height))}else if(Vi(t)){var n=t;n.style.overflow="hidden",e=Math.ceil(Math.max(n.scrollHeight,n.getBoundingClientRect().height))}else{if(!(or(t)&&0<t))return Xe.reject(new Error("Invalid argument. Must be a selector, element, or positive number"));e=t}return e?this.requestWithContext("resize",{height:e}):Xe.reject(new Error("Unable to determine desired height."))},Us.localizeKey=function(t,e){if(window.localizer&&"function"==typeof window.localizer.localize)return window.localizer.localize(t,e);throw new Mr.LocalizerNotFound("No localizer available for localization.")},Us.localizeKeys=function(t){if(!t)return[];var e=this;return t.map(function(t){if("string"==typeof t)return e.localizeKey(t);if(Array.isArray(t))return e.localizeKey(t[0],t[1]);throw new Mr.UnsupportedKeyType("localizeKeys doesn't recognize the supplied key type: ".concat(s(t)))})},Us.localizeNode=function(t){for(var e=t.querySelectorAll("[data-i18n-id],[data-i18n-attrs]"),r=0,n=e.length;r<n;r+=1){var o={},i=e[r];if(i.dataset.i18nArgs)try{o=JSON.parse(i.dataset.i18nArgs)}catch(t){throw new Mr.UnableToParseArgs("Error parsing args. Error: ".concat(t.message))}if(i.dataset.i18nId&&(i.textContent=this.localizeKey(i.dataset.i18nId,o)),i.dataset.i18nAttrs){var s=void 0;try{s=JSON.parse(i.dataset.i18nAttrs)}catch(t){throw new Mr.UnableToParseAttrs("Error parsing attrs. Error: ".concat(t.message))}s&&s.placeholder&&(i.placeholder=this.localizeKey(s.placeholder,o))}}},Us.card=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("card",{fields:e})},Us.cards=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("cards",{fields:e})},Us.list=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("list",{fields:e})},Us.lists=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("lists",{fields:e})},Us.member=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("member",{fields:e})},Us.board=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("board",{fields:e})},Us.organization=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return this.requestWithContext("organization",{fields:e})},Us.attach=function(t){if(!this.memberCanWriteToModel("card"))throw new Error("User lacks write permission on card.");return this.requestWithContext("attach-to-card",t)},Us.requestToken=function(t){if(!this.isMemberSignedIn())throw new Error("No active member in context.");return this.requestWithContext("request-token",t)},Us.authorize=function(t,e){var o,i=B.randomId(),s=e||{};if("string"==typeof t)o=t;else{if("function"!=typeof t)throw Oo("authorize requires a url or function that takes a secret and returns a url"),new Error("Invalid arguments passed to authorize");o=t(i)}var a=function(){return!0};s.validToken&&"function"==typeof s.validToken&&(a=s.validToken);var r=s.width||800,n=s.height||600,c=["width=",r,",height=",n,",left=",window.screenX+Math.floor((window.outerWidth-r)/2),",top=",window.screenY+Math.floor((window.outerHeight-n)/2)].join(""),u=function(t,e){var r=window.open(t,"authorize",e);return"function"==typeof s.windowCallback&&s.windowCallback(r),r};return new Xe(function(r){var n;window.addEventListener("storage",(n=r,function t(e){"token"===e.key&&e.newValue&&a(e.newValue)&&(localStorage.removeItem("token"),window.removeEventListener("storage",t,!1),delete window.authorize,n(e.newValue))}),!1),"function"==typeof t?new B({Promise:Xe,local:window,remote:u(o,c),targetOrigin:s.targetOrigin||"*",secret:i,handlers:{value:function(t,e){e&&e.token&&a(e.token)&&(this.stop(),r(e.token))}}}):(window.authorize=function(t){t&&a(t)&&(delete window.authorize,r(t))},u(o,c))})},Us.storeSecret=function(t,e){if(!this.isMemberSignedIn())throw new Error("No active member in context.");var r=this.getContext().member,n="".concat(r,":").concat(t),o=this;return Dr.sha256Digest(n).then(function(n){return o.get("member","private","aescbc").then(function(t){return t||Dr.generateAESCBCKey().then(function(t){return Dr.exportAESCBCKeyToRaw(t)}).then(function(t){return o.set("member","private","aescbc",t).then(function(){return t})})}).then(function(t){return Dr.importAESCBCKeyFromRaw(t).then(function(t){var r=Dr.generateInitVector();return Dr.encryptSecret(r,t,e).then(function(t){var e="".concat(cr(r),";").concat(t);return window.localStorage.setItem(n,e),{key:n,value:e}})})})})},Us.loadSecret=function(t){if(!this.isMemberSignedIn())throw new Error("No active member in context.");var e=this.getContext().member,r=this,n="".concat(e,":").concat(t);return Dr.sha256Digest(n).then(function(t){return window.localStorage.getItem(t)}).then(function(o){return o?r.get("member","private","aescbc").then(function(t){return t?Dr.importAESCBCKeyFromRaw(t).then(function(t){var e=o.substring(0,o.indexOf(";")),r=o.substring(o.indexOf(";")+1),n=ur(e);return Dr.decryptSecret(n,t,r)}):null}):null})},Us.notifyParent=function(t,e){var r=e||{};window.parent.postMessage(t,r.targetOrigin||"*")};var Ms=function(t,e){var r=e||{};return new(r.io||B)({Promise:Xe,local:window,remote:window.parent,targetOrigin:r.targetOrigin||"https://trello.com",secret:r.secret,handlers:t,hostHandlers:r.hostHandlers})},zs=Ur("restApi",["AuthDeniedError","AuthNotReadyError","ApiNotConfiguredError"]),Ls={makeWebCall:function(t){var e,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(!this.t)throw new zs.AuthNotReadyError("The API helper cannot be used from this context. This probably means that you are attemping to use it inside your iframe connector, but outside a capability handler. For more, http://developers.trello.com/v1.0/reference#api-client-availability.");if("function"!=typeof this.t[t])throw new zs.AuthNotReadyError("This method cannot be used in this context. This probably means that you are attemping to use it inside your iframe connector, but outside a capability handler. For more, http://developers.trello.com/v1.0/reference#api-client-availability.");return(e=this.t)[t].apply(e,o(r))}},qs=function(t){return/^[a-z0-9]{64}$/.test(t)};Ls.registerMessageHandler=function(o){var i=this;return new Xe(function(r,n){window.addEventListener("message",function t(e){e.origin===i.authOrigin&&e.source===o&&(e.source.close(),e.data&&qs(e.data)?(window.removeEventListener("message",t,!1),r(e.data)):n(new zs.AuthDeniedError))},!1)})},Ls.TOKEN_KEY="trello_token",Ls.storeToken=function(t){return this.makeWebCall("set",["member","private",this.TOKEN_KEY,t]).then(function(){return t})},Ls.checkForToken=function(){var t;try{t=this.localStorage.getItem(this.TOKEN_KEY)}catch(t){}return t},Ls.fetchAndStoreToken=function(){var t=this,e=this.checkForToken();return e?this.storeToken(e).then(function(){return t.localStorage.removeItem(t.TOKEN_KEY),e}):Xe.resolve(null)},Ls.getToken=function(){var e=this;return this.fetchAndStoreToken().then(function(t){return t||e.makeWebCall("get",["member","private",e.TOKEN_KEY])})},Ls.popupConfig=function(){var t=window.screenX+(window.outerWidth-550)/2,e=window.screenY+(window.outerHeight-725)/2;return"width=".concat(550,",height=").concat(725,",left=").concat(t,",top=").concat(e)},Ls.showAuthPopup=function(t){var e=t.expiration,r=void 0===e?"never":e,n=t.scope,o=void 0===n?"read":n,i=t.returnUrl,s=void 0===i?null:i,a={name:this.appName,key:this.appKey,expiration:r,scope:o};this.makeWebCall("isMemberSignedIn")?(a.callback_method="postMessage",a.response_type="token",a.return_url=window.location.origin):(a.callback_method="fragment",a.response_type="fragment",a.return_url=s||window.location.href);var c="".concat(this.authBase(),"/authorize?");return c+=Object.keys(a).map(function(t){return"".concat(t,"=").concat(encodeURIComponent(a[t]))}).join("&"),window.open(c,"authpopup",this.popupConfig())},Ls.authorize=function(){var o=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Xe(function(e,t){var r,n=o.showAuthPopup(i);r=setInterval(function(){n.closed&&(clearInterval(r),t(new zs.AuthDeniedError))},500),o.getToken().then(function(t){t&&(clearInterval(r),n.close(),e(t))}),o.registerMessageHandler(n).then(e).catch(t)}).then(function(t){return o.storeToken(t)})},Ls.isAuthorized=function(){return this.getToken().then(function(t){return qs(t)})},Ls.checkAndStoreToken=function(){var t=window.location.hash.match(/token=(.+)/);if(t&&2===t.length&&qs(t[1])){var e=t[1];try{this.localStorage.setItem(this.TOKEN_KEY,e)}catch(t){}window.close()}else this.fetchAndStoreToken()};var Hs=function(){function l(t){var e=t.t,r=t.appKey,n=t.appName,o=t.apiOrigin,i=void 0===o?"https://api.trello.com":o,s=t.authOrigin,a=void 0===s?"https://trello.com":s,c=t.localStorage,u=void 0===c?window.localStorage:c;h(this,l),this.appKey=r,this.appName=n,this.apiOrigin=i,this.authOrigin=a,this.t=e,this.localStorage=u}return r(l,[{key:"init",value:function(){this.checkAndStoreToken()}},{key:"apiBase",value:function(){return"".concat(this.apiOrigin,"/1")}},{key:"authBase",value:function(){return"".concat(this.authOrigin,"/1")}}]),l}();Object.keys(Ls).forEach(function(t){Hs.prototype[t]=Ls[t]});var Vs=function(){function t(i){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};h(this,t),this.handlers={},this.io=null,this.NotHandled=B.NotHandled,this.options=s;var e=this;Object.keys(i).forEach(function(o){e.handlers[o]=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=this;return window.locale=e[1].locale,Qr(window.locale,s).then(function(){return Xe.try(function(){return i[o].apply(n,e)}).then(Ds)})}}),this.handlers.callback=function(t,e){return Ro.callback.call(this,t,e,Ds)};["requestWithContext","getAll","get","set","remove","safe","localizeKey","localizeKeys","localizeNode","board","cards","lists","member","organization"].forEach(function(t){So(Us,t)&&(e[t]=Us[t])})}return r(t,[{key:"connect",value:function(){var t=this,e=Ms(this.handlers,m(this.options,{secret:Io("secret"),hostHandlers:m(Us,{getRestApi:function(){if(!t.restApi)throw new zs.ApiNotConfiguredError("To use the API helper, make sure you specify appKey and appName when you call TrelloPowerup.initialize. For more, https://developers.trello.com/v1.0/reference#rest-api.");return t.restApi.t=this,t.restApi}})}));return(this.io=e).request("initialize",Object.keys(this.handlers)).then(function(t){return e.secret=t.secret,e.request("ready")}).then(function(){return e})}},{key:"request",value:function(t,e){return this.io.request(t,e)}},{key:"init",value:function(){var t=this;return this.options.appKey&&this.options.appName?(this.restApi=new Hs({t:this,appKey:this.options.appKey,appName:this.options.appName,apiOrigin:this.options.apiOrigin,authOrigin:this.options.authOrigin,localStorage:this.options.localStorage}),this.connect().tap(function(){return t.restApi.init()})):((this.options.appKey||this.options.appName)&&Oo("Both appKey and appName must be included to use the API. See more https://developers.trello.com/v1.0/reference#rest-api."),this.connect())}}]),t}();Vs.prototype.NotHandled=B.NotHandled;var Ws=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};h(this,e),this.io=null,this.args=[{context:Io("context",t.context),secret:Io("secret",t.secret)}].concat(Io("args")),this.secret=Io("secret",t.secret),this.options=t,window.locale=Io("locale","en")}return r(e,[{key:"init",value:function(){this.connect(),this.initApi()}},{key:"connect",value:function(){var t={callback:function(t,e){return Ro.callback.call(this,t,e,Ds)}};this.io=Ms(t,m(this.options,{secret:Io("secret"),hostHandlers:Us}))}},{key:"request",value:function(t,e){return this.io.request(t,e)}},{key:"render",value:function(e){var r=this;window.addEventListener("message",function(t){t.source===window.parent&&"render"===t.data&&Qr(window.locale,r.options).then(function(){e()})},!1)}},{key:"initApi",value:function(){this.options.appKey&&this.options.appName?(this.restApi=new Hs({t:this,appKey:this.options.appKey,appName:this.options.appName,apiOrigin:this.options.apiOrigin,authOrigin:this.options.authOrigin,localStorage:this.options.localStorage}),this.restApi.init()):(this.options.appKey||this.options.appName)&&Oo("Both appKey and appName must be included to use the API. See more at https://developers.trello.com/v1.0/reference#rest-api.")}},{key:"getRestApi",value:function(){if(!this.restApi)throw new zs.ApiNotConfiguredError("To use the API helper, make sure you specify appKey and appName when you call TrelloPowerUp.iframe. See more at https://developers.trello.com/v1.0/reference#rest-api");return this.restApi}}]),e}(),Ks;for(var $s in Ws.prototype.NotHandled=B.NotHandled,Us)So(Us,$s)&&(Ws.prototype[$s]=Us[$s]);Ks=window.Element.prototype,Ks.matches=Ks.matches||Ks.mozMatchesSelector||Ks.msMatchesSelector||Ks.oMatchesSelector||Ks.webkitMatchesSelector,Ks.closest=Ks.closest||function(t){for(var e=this;e&&!e.matches(t);)e=e.parentElement;return e};var Qs=function(){function t(){h(this,t),this.version="1.15.1",this.CallbackCache=Ro,this.PostMessageIO=B,this.Promise=Xe,this.util={colors:{getHexString:sr,namedColorStringToHex:ar},convert:{bytesToHexString:cr,hexStringToUint8Array:ur},crypto:Dr,initLocalizer:Qr,makeErrorEnum:Ur,relativeUrl:Jr},this.restApiError=zs,this.initialize=this.initialize.bind(this),this.iframe=this.iframe.bind(this)}return r(t,[{key:"initialize",value:function(t,e){return null!=this.iframeConnector&&Oo("Cannot call TrelloPowerUp.initialize() from a secondary iframe where you have already called TrelloPowerUp.iframe(). TrelloPowerUp.initialize() should only be called from your index connector page, and should not include a call to TrelloPowerUp.iframe()"),null!=this.indexConnector?Oo("Warning: calling TrelloPowerUp.initialize() more than once will have no effect. It is expected that you call it only once on your index connector."):(this.indexConnector=new Vs(t,e),this.indexConnector.init()),this.indexConnector}},{key:"iframe",value:function(t){return null!=this.indexConnector&&Oo("Cannot call TrelloPowerUp.iframe() from your index connector where you call TrelloPowerUp.initialize(). TrelloPowerUp.iframe() is only used for secondary iframes you may create or request from Trello during the Power-Up lifecycle."),null!=this.iframeConnector||(this.iframeConnector=new Ws(t),this.iframeConnector.init()),this.iframeConnector}}]),t}();window.TrelloPowerUp=new Qs});
